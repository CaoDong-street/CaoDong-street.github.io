<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="python学习笔记（数据分析）, Cao Dong">
    <meta name="description" content="">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>python学习笔记（数据分析） | Cao Dong</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<meta name="generator" content="Hexo 5.4.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="Cao Dong" type="application/atom+xml">
</head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Cao Dong</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Cao Dong</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/CaoDong-street" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/CaoDong-street" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/13.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">python学习笔记（数据分析）</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/python/">
                                <span class="chip bg-color">python</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%BB%8F%E9%AA%8C/" class="post-category">
                                学习经验
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2021-09-21
                </div>
                

                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    20.4k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    88 分
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="学习书籍-《利用Python进行数据分析·第2版》"><a href="#学习书籍-《利用Python进行数据分析·第2版》" class="headerlink" title="学习书籍: 《利用Python进行数据分析·第2版》"></a>学习书籍: <a target="_blank" rel="noopener" href="https://www.bookstack.cn/read/pyda-2e-zh/README.md">《利用Python进行数据分析·第2版》</a></h1><h2 id="第02章-Python语法基础"><a href="#第02章-Python语法基础" class="headerlink" title="第02章 Python语法基础"></a><a target="_blank" rel="noopener" href="https://www.bookstack.cn/read/pyda-2e-zh/2.md">第02章 Python语法基础</a></h2><h3 id="2-3-Python语法基础"><a href="#2-3-Python语法基础" class="headerlink" title="2.3 Python语法基础"></a><a target="_blank" rel="noopener" href="https://www.bookstack.cn/read/pyda-2e-zh/2.3.md">2.3 Python语法基础</a></h3><h4 id="组织代码方式"><a href="#组织代码方式" class="headerlink" title="组织代码方式"></a>组织代码方式</h4><p><em>Python使用空白字符（tab和空格）来组织代码，而不是通过括号（）</em></p>
<p>例子：排序算法的for循环</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">for x in array</span><span class="token punctuation">:</span>
    <span class="token key atrule">if x &lt; pivot</span><span class="token punctuation">:</span>
        less.append(x)
    <span class="token key atrule">else</span><span class="token punctuation">:</span>
        greater.append(x)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><em>Python的语句不需要用分号结尾。但是，分号却可以用来给同在一行的语句切分</em></p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">a = 5; b = 6; c = 7<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h4 id="万物皆对象"><a href="#万物皆对象" class="headerlink" title="万物皆对象"></a>万物皆对象</h4><p>Python语言的一个重要特性就是它的对象模型的一致性。每个数字、字符串、数据结构、函数、类、模块等等，都是在Python解释器的自有“盒子”内，它被认为是Python对象。每个对象都有类型（例如，字符串或函数）和内部数据。在实际中，这可以让语言非常灵活，因为函数也可以被当做对象使用。</p>
<p><em>注释标记为#</em></p>
<p>例子：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">results = <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token key atrule">for line in file_handle</span><span class="token punctuation">:</span>
    <span class="token comment"># keep the empty lines for now</span>
    <span class="token comment"># if len(line) == 0:</span>
    <span class="token comment">#   continue</span>
    results.append(line.replace('foo'<span class="token punctuation">,</span> 'bar'))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="变量与参数传递"><a href="#变量与参数传递" class="headerlink" title="变量与参数传递"></a>变量与参数传递</h4><p>创建一个整数列表：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a = <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>假设将a赋值给一个新变量b：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">:</span> b = a<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>在Python中，a和b实际上是同一个对象，即原有列表[1, 2, 3]。你可以在a中添加一个元素，然后检查b：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a.append(4)

In <span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">:</span> b
Out<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="python是强类型化语言"><a href="#python是强类型化语言" class="headerlink" title="python是强类型化语言"></a>python是强类型化语言</h4><p><em>python是强类型化语言，意味着每个对象都有明确的类型（或类）（str型不能与int型相加），默许转换只会发生在特定的情况下（float型能与int型相加）</em><br>例子1：str型不能与int型相加</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">:</span> '5' + 5
<span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span>
TypeError                                 Traceback (most recent call last)
&lt;ipython<span class="token punctuation">-</span>input<span class="token punctuation">-</span>16<span class="token punctuation">-</span>f9dbf5f0b234<span class="token punctuation">&gt;</span> in &lt;module<span class="token punctuation">&gt;</span>()
<span class="token punctuation">---</span><span class="token punctuation">-</span><span class="token punctuation">&gt;</span> 1 '5' + 5
<span class="token key atrule">TypeError</span><span class="token punctuation">:</span> must be str<span class="token punctuation">,</span> not int<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>例子2：loat型能与int型相加</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a = 4.5
In <span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token punctuation">:</span> b = 2
<span class="token comment"># String formatting, to be visited later</span>
In <span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token punctuation">:</span> print('a is <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span> b is <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span>'.format(type(a)<span class="token punctuation">,</span> type(b)))
a is &lt;class 'float'<span class="token punctuation">&gt;</span><span class="token punctuation">,</span> b is &lt;class 'int'<span class="token punctuation">&gt;</span>
In <span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a / b
Out<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">2.25</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><em><strong>isinstance</strong></em>函数 : 检查对象是某个类型的实例,可以用类型元组，检查对象的类型是否在元组中</p>
<p><em>Python的对象通常都有属性（其它存储在对象内部的Python对象）和方法（对象的附属函数可以访问对象的内部数据）</em></p>
<h4 id="可迭代对象"><a href="#可迭代对象" class="headerlink" title="可迭代对象"></a>可迭代对象</h4><p><strong>Iterable object（可迭代对象）</strong><br>可迭代（Iterable） 对象是数组的泛化。这个概念是说任何对象都可以被定制为可在 for..of 循环中使用的对象。</p>
<p>数组是可迭代的。但不仅仅是数组。很多其他内建对象也都是可迭代的。例如字符串也是可迭代的。</p>
<p>如果从技术上讲，对象不是数组，而是表示某物的集合（列表，集合），for..of 是一个能够遍历它的很好的语法</p>
<p><em><strong>iter</strong></em>函数 : 判断对象是否是可迭代的</p>
<p>可定义<em><strong>isiterable</strong></em>函数</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">def isiterable(obj)</span><span class="token punctuation">:</span>
    <span class="token key atrule">try</span><span class="token punctuation">:</span>
        iter(obj)
        return True
    <span class="token key atrule">except TypeError</span><span class="token punctuation">:</span> <span class="token comment"># not iterable</span>
        return False<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><em><strong>isiterable</strong></em>函数 ：返回字符串以及大多数Python集合类型为True</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token punctuation">:</span> isiterable('a string')
Out<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token boolean important">True</span>
In <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">:</span> isiterable(<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>)
Out<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token boolean important">True</span>
In <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span><span class="token punctuation">:</span> isiterable(5)
Out<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token boolean important">False</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="引入模块"><a href="#引入模块" class="headerlink" title="引入模块"></a>引入模块</h4><p>在Python中，模块就是一个有.py扩展名、包含Python代码的文件。假设有以下模块：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token comment"># some_module.py</span>
PI = 3.14159
<span class="token key atrule">def f(x)</span><span class="token punctuation">:</span>
    return x + 2
def g(a<span class="token punctuation">,</span> <span class="token key atrule">b)</span><span class="token punctuation">:</span>
    return a + b<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>如果想从同目录下的另一个文件访问<em>some_module.py</em>中定义的变量和函数，可以：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">import some_module
result = some_module.f(5)
pi = some_module.PI<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>或</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">from some_module import f<span class="token punctuation">,</span> g<span class="token punctuation">,</span> PI
result = g(5<span class="token punctuation">,</span> PI)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>使用as关键词，你可以给引入起不同的变量名：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">import some_module as sm
from some_module import PI as pi<span class="token punctuation">,</span> g as gf
r1 = sm.f(pi)
r2 = gf(6<span class="token punctuation">,</span> pi)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="二元运算符和比较运算符"><a href="#二元运算符和比较运算符" class="headerlink" title="二元运算符和比较运算符"></a>二元运算符和比较运算符</h4><p><em>要判断两个引用是否指向同一个对象，可以使用</em><strong>is</strong><em>方法。</em><strong>is not</strong><em>方法可以判断两个对象是不同的（因为</em><strong>list</strong><em>总是创建一个新的Python列表（即复制），我们可以断定c是不同于a的。使用is比较与==运算符不同，如下）：</em></p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a = <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
In <span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span><span class="token punctuation">:</span> b = a
In <span class="token punctuation">[</span><span class="token number">37</span><span class="token punctuation">]</span><span class="token punctuation">:</span> c = list(a)
In <span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a is b
Out<span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token boolean important">True</span>
In <span class="token punctuation">[</span><span class="token number">39</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a is not c
Out<span class="token punctuation">[</span><span class="token number">39</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token boolean important">True</span>
In <span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a == c
Out<span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token boolean important">True</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://tvax3.sinaimg.cn/large/007mx13gly1gum94jxbkuj60mj0elqao02.jpg" alt="二元运算符和比较运算符"></p>
<h4 id="可变与不可变对象"><a href="#可变与不可变对象" class="headerlink" title="可变与不可变对象"></a>可变与不可变对象</h4><p><em>Python中的大多数对象(列表、字典、NumPy数组，和用户定义的类型（类）)都是可变对象），即这些对象或包含的值可以被修改，而字符串和元组为不可变对象</em></p>
<p><img src="https://tva1.sinaimg.cn/large/007mx13gly1gumtsu38qdj60mg068n0l02.jpg" alt="标量类型"></p>
<h4 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h4><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token comment">#单引号或双引号来写字符串</span>
a ='one way of writing a string'
b ="another way"
<span class="token comment">#对于有换行符的字符串，可以使用三引号，’’’或”””写字符串</span>
    c ="""
    This is a longer string that
    spans multiple lines
    """<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Python的字符串是不可变的，不能修改字符串</p>
<p>str函数：可以被转化为字符串</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In<span class="token punctuation">[</span><span class="token number">61</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a =5.6
In<span class="token punctuation">[</span><span class="token number">62</span><span class="token punctuation">]</span><span class="token punctuation">:</span> s = str(a)
In<span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">]</span><span class="token punctuation">:</span>print(s)
5.6<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>字符串是一个序列的Unicode字符，因此可以像其它序列，比如列表和元组一样处理：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">:</span> s ='python'
In<span class="token punctuation">[</span><span class="token number">65</span><span class="token punctuation">]</span><span class="token punctuation">:</span> list(s)
Out<span class="token punctuation">[</span><span class="token number">65</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'p'</span><span class="token punctuation">,</span><span class="token string">'y'</span><span class="token punctuation">,</span><span class="token string">'t'</span><span class="token punctuation">,</span><span class="token string">'h'</span><span class="token punctuation">,</span><span class="token string">'o'</span><span class="token punctuation">,</span><span class="token string">'n'</span><span class="token punctuation">]</span>
In<span class="token punctuation">[</span><span class="token number">66</span><span class="token punctuation">]</span><span class="token punctuation">:</span> s<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span>
Out<span class="token punctuation">[</span><span class="token number">66</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token string">'pyt'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>语法s[:3]被称作切片，适用于许多Python序列。</p>
<p><em>反斜杠是转义字符</em></p>
<p>意思是它备用来表示特殊字符，比如换行符\n或Unicode字符。要写一个包含反斜杠的字符串，需要进行转义：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In<span class="token punctuation">[</span><span class="token number">67</span><span class="token punctuation">]</span><span class="token punctuation">:</span> s ='12\\34'
In<span class="token punctuation">[</span><span class="token number">68</span><span class="token punctuation">]</span><span class="token punctuation">:</span>print(s)
12\34<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><em>可以在字符串前面加一个r(代表raw)，表明字符就是它自身</em></p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In<span class="token punctuation">[</span><span class="token number">71</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a ='this is the first half '
In<span class="token punctuation">[</span><span class="token number">72</span><span class="token punctuation">]</span><span class="token punctuation">:</span> b ='and this is the second half'
In<span class="token punctuation">[</span><span class="token number">73</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a + b
Out<span class="token punctuation">[</span><span class="token number">73</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token string">'this is the first half and this is the second half'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>字符串对象有format方法，可以替换格式化的参数为字符串，产生一个新的字符串：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In<span class="token punctuation">[</span><span class="token number">74</span><span class="token punctuation">]</span><span class="token punctuation">:</span> template ='<span class="token punctuation">{</span>0<span class="token punctuation">:</span>.2f<span class="token punctuation">}</span> <span class="token punctuation">{</span>1<span class="token punctuation">:</span>s<span class="token punctuation">}</span> are worth US$<span class="token punctuation">{</span>2<span class="token punctuation">:</span>d<span class="token punctuation">}</span>'
<span class="token comment">#{0:.2f}表示格式化第一个参数为带有两位小数的浮点数。</span>
<span class="token comment">#{1:s}表示格式化第二个参数为字符串。</span>
<span class="token comment">#{2:d}表示格式化第三个参数为一个整数。</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>要替换参数为这些格式化的参数，我们传递format方法一个序列：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In<span class="token punctuation">[</span><span class="token number">75</span><span class="token punctuation">]</span><span class="token punctuation">:</span> template.format(4.5560<span class="token punctuation">,</span><span class="token string">'Argentine Pesos'</span><span class="token punctuation">,</span>1)
Out<span class="token punctuation">[</span><span class="token number">75</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token string">'4.56 Argentine Pesos are worth US$1'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h4 id="字节和Unicode"><a href="#字节和Unicode" class="headerlink" title="字节和Unicode"></a>字节和Unicode</h4><p>在Python 3及以上版本中，Unicode是一级的字符串类型，这样可以更一致的处理ASCII和Non-ASCII文本。在老的Python版本中，字符串都是字节，不使用Unicode编码。<br>相关函数：<em><strong>encode</strong></em> <em><strong>decode</strong></em></p>
<h4 id="布尔值"><a href="#布尔值" class="headerlink" title="布尔值"></a>布尔值</h4><p>Python中的布尔值有两个，True和False</p>
<h4 id="类型转换"><a href="#类型转换" class="headerlink" title="类型转换"></a>类型转换</h4><p>str、bool、int和float也是函数，可以用来转换类型：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In<span class="token punctuation">[</span><span class="token number">91</span><span class="token punctuation">]</span><span class="token punctuation">:</span> s ='3.14159'
In<span class="token punctuation">[</span><span class="token number">92</span><span class="token punctuation">]</span><span class="token punctuation">:</span> fval = float(s)
In<span class="token punctuation">[</span><span class="token number">93</span><span class="token punctuation">]</span><span class="token punctuation">:</span> type(fval)
Out<span class="token punctuation">[</span><span class="token number">93</span><span class="token punctuation">]</span><span class="token punctuation">:</span> float
In<span class="token punctuation">[</span><span class="token number">94</span><span class="token punctuation">]</span><span class="token punctuation">:</span> int(fval)
Out<span class="token punctuation">[</span><span class="token number">94</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token number">3</span>
In<span class="token punctuation">[</span><span class="token number">95</span><span class="token punctuation">]</span><span class="token punctuation">:</span> bool(fval)
Out<span class="token punctuation">[</span><span class="token number">95</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token boolean important">True</span>
In<span class="token punctuation">[</span><span class="token number">96</span><span class="token punctuation">]</span><span class="token punctuation">:</span> bool(0)
Out<span class="token punctuation">[</span><span class="token number">96</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token boolean important">False</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="None"><a href="#None" class="headerlink" title="None"></a>None</h4><p>None是Python的空值类型。如果一个函数没有明确的返回值，就会默认返回None：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In<span class="token punctuation">[</span><span class="token number">97</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a =None
In<span class="token punctuation">[</span><span class="token number">98</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a isNone
Out<span class="token punctuation">[</span><span class="token number">98</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token boolean important">True</span>
In<span class="token punctuation">[</span><span class="token number">99</span><span class="token punctuation">]</span><span class="token punctuation">:</span> b =5
In<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">:</span> b isnotNone
Out<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token boolean important">True</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>None也常常作为函数的默认参数</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">def add_and_maybe_multiply(a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token key atrule">c=None)</span><span class="token punctuation">:</span>
    result = a + b
<span class="token key atrule">if c isnotNone</span><span class="token punctuation">:</span>
        result = result * c
return result<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>另外，None不仅是一个保留字，还是唯一的NoneType的实例：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In<span class="token punctuation">[</span><span class="token number">101</span><span class="token punctuation">]</span><span class="token punctuation">:</span> type(None)
Out<span class="token punctuation">[</span><span class="token number">101</span><span class="token punctuation">]</span><span class="token punctuation">:</span>NoneType<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h4 id="日期和时间"><a href="#日期和时间" class="headerlink" title="日期和时间"></a>日期和时间</h4><p>Python内建的datetime模块提供了datetime、date和time类型。datetime类型结合了date和time，是最常使用的：</p>
<p>Python内建的datetime模块提供了datetime、date和time类型。datetime类型结合了date和time，是最常使用的：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In<span class="token punctuation">[</span><span class="token number">102</span><span class="token punctuation">]</span><span class="token punctuation">:</span>from datetime import datetime<span class="token punctuation">,</span> date<span class="token punctuation">,</span> time
In<span class="token punctuation">[</span><span class="token number">103</span><span class="token punctuation">]</span><span class="token punctuation">:</span> dt = datetime(2011<span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">29</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span>21)
In<span class="token punctuation">[</span><span class="token number">104</span><span class="token punctuation">]</span><span class="token punctuation">:</span> dt.day
Out<span class="token punctuation">[</span><span class="token number">104</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token number">29</span>
In<span class="token punctuation">[</span><span class="token number">105</span><span class="token punctuation">]</span><span class="token punctuation">:</span> dt.minute
Out<span class="token punctuation">[</span><span class="token number">105</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token number">30</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>根据datetime实例，你可以用date和time提取出各自的对象：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In<span class="token punctuation">[</span><span class="token number">106</span><span class="token punctuation">]</span><span class="token punctuation">:</span> dt.date()
Out<span class="token punctuation">[</span><span class="token number">106</span><span class="token punctuation">]</span><span class="token punctuation">:</span> datetime.date(2011<span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span>29)
In<span class="token punctuation">[</span><span class="token number">107</span><span class="token punctuation">]</span><span class="token punctuation">:</span> dt.time()
Out<span class="token punctuation">[</span><span class="token number">107</span><span class="token punctuation">]</span><span class="token punctuation">:</span> datetime.time(20<span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span>21)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>strftime方法可以将datetime格式化为字符串：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In<span class="token punctuation">[</span><span class="token number">108</span><span class="token punctuation">]</span><span class="token punctuation">:</span> dt.strftime('%m/%d/%Y %H<span class="token punctuation">:</span>%M')
Out<span class="token punctuation">[</span><span class="token number">108</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token string">'10/29/2011 20:30'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>strptime可以将字符串转换成datetime对象：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In<span class="token punctuation">[</span><span class="token number">109</span><span class="token punctuation">]</span><span class="token punctuation">:</span> datetime.strptime('20091031'<span class="token punctuation">,</span>'%Y%m%d')
Out<span class="token punctuation">[</span><span class="token number">109</span><span class="token punctuation">]</span><span class="token punctuation">:</span> datetime.datetime(2009<span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">31</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>0)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><img src="https://tva3.sinaimg.cn/large/007mx13gly1gun84pnb4aj60j80b178b02.jpg" alt="格式化指令"></p>
<p><u>聚类或对时间序列进行分组</u>，替换datetimes的time字段有时会很有用。例如，用0替换分和秒：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In<span class="token punctuation">[</span><span class="token number">110</span><span class="token punctuation">]</span><span class="token punctuation">:</span> dt.replace(minute=0<span class="token punctuation">,</span> second=0)
Out<span class="token punctuation">[</span><span class="token number">110</span><span class="token punctuation">]</span><span class="token punctuation">:</span> datetime.datetime(2011<span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">29</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span>0)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>因为datetime.datetime是不可变类型，上面的方法会产生新的对象。</p>
<p>两个datetime对象的差会产生一个datetime.timedelta类型：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In<span class="token punctuation">[</span><span class="token number">111</span><span class="token punctuation">]</span><span class="token punctuation">:</span> dt2 = datetime(2011<span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span>30)
In<span class="token punctuation">[</span><span class="token number">112</span><span class="token punctuation">]</span><span class="token punctuation">:</span> delta = dt2 <span class="token punctuation">-</span> dt
In<span class="token punctuation">[</span><span class="token number">113</span><span class="token punctuation">]</span><span class="token punctuation">:</span> delta
Out<span class="token punctuation">[</span><span class="token number">113</span><span class="token punctuation">]</span><span class="token punctuation">:</span> datetime.timedelta(17<span class="token punctuation">,</span>7179)
In<span class="token punctuation">[</span><span class="token number">114</span><span class="token punctuation">]</span><span class="token punctuation">:</span> type(delta)
Out<span class="token punctuation">[</span><span class="token number">114</span><span class="token punctuation">]</span><span class="token punctuation">:</span> datetime.timedelta<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>结果timedelta(17, 7179)指明了timedelta将17天、7179秒的编码方式。</p>
<p>将timedelta添加到datetime，会产生一个新的偏移datetime：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In<span class="token punctuation">[</span><span class="token number">115</span><span class="token punctuation">]</span><span class="token punctuation">:</span> dt
Out<span class="token punctuation">[</span><span class="token number">115</span><span class="token punctuation">]</span><span class="token punctuation">:</span> datetime.datetime(2011<span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">29</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span>21)
In<span class="token punctuation">[</span><span class="token number">116</span><span class="token punctuation">]</span><span class="token punctuation">:</span> dt + delta
Out<span class="token punctuation">[</span><span class="token number">116</span><span class="token punctuation">]</span><span class="token punctuation">:</span> datetime.datetime(2011<span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span>30)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="控制流"><a href="#控制流" class="headerlink" title="控制流"></a><strong>控制流</strong></h4><p>Python有若干内建的关键字进行条件逻辑、循环和其它控制流操作。<br>if、elif和else</p>
<h5 id="if"><a href="#if" class="headerlink" title="if"></a><em>if</em></h5><p>if是最广为人知的控制流语句。它检查一个条件，如果为True，就执行后面的语句：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">if x &lt;0</span><span class="token punctuation">:</span>
print('It's negative')<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>if后面可以跟一个或多个elif，所有条件都是False时，还可以添加一个else：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">if x &lt;0</span><span class="token punctuation">:</span>
print('It's negative')
<span class="token key atrule">elif x == 0</span><span class="token punctuation">:</span>
    print('Equal to zero')
<span class="token key atrule">elif 0 &lt; x &lt; 5</span><span class="token punctuation">:</span>
    print('Positive but smaller than 5')
<span class="token key atrule">else</span><span class="token punctuation">:</span>
    print('Positiveand larger than or equal to 5')<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>如果某个条件为True，后面的elif就不会被执行。当使用and和or时，复合条件语句是从左到右执行：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In<span class="token punctuation">[</span><span class="token number">117</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a =5; b =7
In<span class="token punctuation">[</span><span class="token number">118</span><span class="token punctuation">]</span><span class="token punctuation">:</span> c =8; d =4
In<span class="token punctuation">[</span><span class="token number">119</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token key atrule">if a &lt; b or c &gt; d</span><span class="token punctuation">:</span>
<span class="token punctuation">...</span>..<span class="token punctuation">:</span>print('Made it')
Made it<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在这个例子中，c &gt; d不会被执行，因为第一个比较是True：</p>
<p>也可以把比较式串在一起：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In<span class="token punctuation">[</span><span class="token number">120</span><span class="token punctuation">]</span><span class="token punctuation">:</span>4<span class="token punctuation">&gt;</span>3<span class="token punctuation">&gt;</span>2<span class="token punctuation">&gt;</span>1
Out<span class="token punctuation">[</span><span class="token number">120</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token boolean important">True</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h5 id="for循环"><a href="#for循环" class="headerlink" title="for循环"></a><em>for循环</em></h5><p>for循环是在一个集合（列表或元组）中进行迭代，或者就是一个迭代器。for循环的标准语法是：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">for value in collection</span><span class="token punctuation">:</span>
<span class="token comment"># do something with value</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>你可以用continue使for循环提前，跳过剩下的部分。看下面这个例子，将一个列表中的整数相加，跳过None：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">sequence =<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>None<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span>None<span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span>
total =0
<span class="token key atrule">for value in sequence</span><span class="token punctuation">:</span>
<span class="token key atrule">if value isNone</span><span class="token punctuation">:</span>
continue
    total += value<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>可以用break跳出for循环。下面的代码将各元素相加，直到遇到5：</p>
<pre><code>sequence =[1,2,0,4,6,5,2,1]
total_until_5 =0
for value in sequence:
if value ==5:
break
    total_until_5 += value
</code></pre>
<p>break只中断for循环的最内层，其余的for循环仍会运行：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In<span class="token punctuation">[</span><span class="token number">121</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token key atrule">for i in range(4)</span><span class="token punctuation">:</span>
<span class="token key atrule">.....:for j in range(4)</span><span class="token punctuation">:</span>
<span class="token key atrule">.....:if j &gt; i</span><span class="token punctuation">:</span>
<span class="token punctuation">...</span>..<span class="token punctuation">:</span>break
<span class="token punctuation">...</span>..<span class="token punctuation">:</span>print((i<span class="token punctuation">,</span> j))
<span class="token key atrule">.....</span><span class="token punctuation">:</span>
(0<span class="token punctuation">,</span>0)
(1<span class="token punctuation">,</span>0)
(1<span class="token punctuation">,</span>1)
(2<span class="token punctuation">,</span>0)
(2<span class="token punctuation">,</span>1)
(2<span class="token punctuation">,</span>2)
(3<span class="token punctuation">,</span>0)
(3<span class="token punctuation">,</span>1)
(3<span class="token punctuation">,</span>2)
(3<span class="token punctuation">,</span>3)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>如果集合或迭代器中的元素序列（元组或列表），可以用for循环将其方便地拆分成变量：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">for a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token key atrule">c in iterator</span><span class="token punctuation">:</span>
<span class="token comment"># do something</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h5 id="While循环"><a href="#While循环" class="headerlink" title="While循环"></a><em>While循环</em></h5><p>while循环指定了条件和代码，当条件为False或用break退出循环，代码才会退出：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">x =256
total =0
<span class="token key atrule">while x &gt;0</span><span class="token punctuation">:</span>
<span class="token key atrule">if total &gt;500</span><span class="token punctuation">:</span>
break
    total += x
    x = x //2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="pass非操作语句"><a href="#pass非操作语句" class="headerlink" title="pass非操作语句"></a><em>pass非操作语句</em></h5><p>pass是Python中的非操作语句。代码块不需要任何动作时可以使用（作为未执行代码的占位符）；因为Python需要使用空白字符划定代码块，所以需要pass：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">if x &lt;0</span><span class="token punctuation">:</span>
print('negative<span class="token tag">!')</span>
<span class="token key atrule">elif x ==0</span><span class="token punctuation">:</span>
<span class="token comment"># TODO: put something smart here</span>
pass
<span class="token key atrule">else</span><span class="token punctuation">:</span>
print('positive<span class="token tag">!')</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="range函数"><a href="#range函数" class="headerlink" title="range函数"></a><em>range函数</em></h5><p>range函数返回一个迭代器，它产生一个均匀分布的整数序列：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In<span class="token punctuation">[</span><span class="token number">122</span><span class="token punctuation">]</span><span class="token punctuation">:</span> range(10)
Out<span class="token punctuation">[</span><span class="token number">122</span><span class="token punctuation">]</span><span class="token punctuation">:</span> range(0<span class="token punctuation">,</span>10)
In<span class="token punctuation">[</span><span class="token number">123</span><span class="token punctuation">]</span><span class="token punctuation">:</span> list(range(10))
Out<span class="token punctuation">[</span><span class="token number">123</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>range的三个参数是（起点，终点，步进）：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In<span class="token punctuation">[</span><span class="token number">124</span><span class="token punctuation">]</span><span class="token punctuation">:</span> list(range(0<span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span>2))
Out<span class="token punctuation">[</span><span class="token number">124</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">]</span>
In<span class="token punctuation">[</span><span class="token number">125</span><span class="token punctuation">]</span><span class="token punctuation">:</span> list(range(5<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">-</span>1))
Out<span class="token punctuation">[</span><span class="token number">125</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>可以看到，<u>range产生的整数不包括终点</u>。range的常见用法是用序号迭代序列：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">seq =<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span>
<span class="token key atrule">for i in range(len(seq))</span><span class="token punctuation">:</span>
    val = seq<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>可以使用list来存储range在其他数据结构中生成的所有整数，默认的迭代器形式通常是你想要的。下面的代码对0到99999中3或5的倍数求和：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">sum =0
<span class="token key atrule">for i in range(100000)</span><span class="token punctuation">:</span>
<span class="token comment"># % is the modulo operator</span>
<span class="token key atrule">if i %3==0or i %5==0</span><span class="token punctuation">:</span>
        sum += i<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>虽然range可以产生任意大的数，但任意时刻耗用的内存却很小。<br>三元表达式</p>
<h4 id="三元表达式"><a href="#三元表达式" class="headerlink" title="三元表达式"></a>三元表达式</h4><p>Python中的三元表达式可以将if-else语句放到一行里。语法如下：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">value = true<span class="token punctuation">-</span>expr if condition else false<span class="token punctuation">-</span>expr<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>true-expr或false-expr可以是任何Python代码。它和下面的代码效果相同：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">if condition</span><span class="token punctuation">:</span>
    value = true<span class="token punctuation">-</span>expr
<span class="token key atrule">else</span><span class="token punctuation">:</span>
    value = false<span class="token punctuation">-</span>expr<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>下面是一个更具体的例子：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In<span class="token punctuation">[</span><span class="token number">126</span><span class="token punctuation">]</span><span class="token punctuation">:</span> x =5
In<span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">]</span><span class="token punctuation">:</span>'Non<span class="token punctuation">-</span>negative'if x <span class="token punctuation">&gt;</span>=0else'Negative'
Out<span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token string">'Non-negative'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>和if-else一样，只有一个表达式会被执行。因此，三元表达式中的if和else可以包含大量的计算，但只有True的分支会被执行。因此，三元表达式中的if和else可以包含大量的计算，但只有True的分支会被执行。</p>
<p>虽然使用三元表达式可以压缩代码，但会降低<u>代码可读性</u>。</p>
<h2 id="第03章-Python的数据结构、函数和文件"><a href="#第03章-Python的数据结构、函数和文件" class="headerlink" title="第03章 Python的数据结构、函数和文件"></a><a target="_blank" rel="noopener" href="https://www.bookstack.cn/read/pyda-2e-zh/3.md">第03章 Python的数据结构、函数和文件</a></h2><h3 id="3-1-数据结构和序列"><a href="#3-1-数据结构和序列" class="headerlink" title="3.1 数据结构和序列"></a><a target="_blank" rel="noopener" href="https://www.bookstack.cn/read/pyda-2e-zh/3.1.md">3.1 数据结构和序列</a></h3><h4 id="元组"><a href="#元组" class="headerlink" title="元组"></a>元组</h4><p>元组是<u>一个固定长度，不可改变的Python序列对象</u>。创建元组的最简单方式，是用<u>逗号分隔一列值</u>：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span> tup = 4<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span>
In <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">:</span> tup
Out<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">:</span> (4<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> 6)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>当用复杂的表达式定义元组，最好将值放到<u>圆括号</u>内，如下所示：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">:</span> nested_tup = (4<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> 6)<span class="token punctuation">,</span> (7<span class="token punctuation">,</span> 8)
In <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">:</span> nested_tup
Out<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">:</span> ((4<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> 6)<span class="token punctuation">,</span> (7<span class="token punctuation">,</span> 8))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>用<u>tuple可以将任意序列或迭代器</u>转换成元组：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">:</span> tuple(<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>)
Out<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">:</span> (4<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> 2)
In <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">:</span> tup = tuple('string')
In <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">:</span> tup
Out<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">:</span> ('s'<span class="token punctuation">,</span> <span class="token string">'t'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> <span class="token string">'i'</span><span class="token punctuation">,</span> <span class="token string">'n'</span><span class="token punctuation">,</span> 'g')<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>可以用方括号访问元组中的元素。和C、C++、JAVA等语言一样，<u>序列是从0开始的</u>：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">:</span> tup<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
Out<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'s'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>元组中存储的对象可能是可变对象。<u>一旦创建了元组，元组中的对象就不能修改了</u>：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">:</span> tup = tuple(<span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token boolean important">True</span><span class="token punctuation">]</span>)
In <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">:</span> tup<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> = False
<span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span>
TypeError                                 Traceback (most recent call last)
&lt;ipython<span class="token punctuation">-</span>input<span class="token punctuation">-</span>10<span class="token punctuation">-</span>c7308343b841<span class="token punctuation">&gt;</span> in &lt;module<span class="token punctuation">&gt;</span>()
<span class="token punctuation">---</span><span class="token punctuation">-</span><span class="token punctuation">&gt;</span> 1 tup<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> = False
<span class="token key atrule">TypeError</span><span class="token punctuation">:</span> 'tuple' object does not support item assignment<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><u>如果元组中的某个对象是可变的，比如列表，可以在原位进行修改</u>：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">:</span> tup<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>.append(3)
In <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">:</span> tup
Out<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">:</span> ('foo'<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> True)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>可以用<u>加号运算符将元组串联起来</u>：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">:</span> (4<span class="token punctuation">,</span> None<span class="token punctuation">,</span> 'foo') + (6<span class="token punctuation">,</span> 0) + ('bar'<span class="token punctuation">,</span>)
Out<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">:</span> (4<span class="token punctuation">,</span> None<span class="token punctuation">,</span> <span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> 'bar')<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>元组乘以一个整数，像列表一样，会将几个元组的复制串联起来：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">:</span> ('foo'<span class="token punctuation">,</span> 'bar') * 4
Out<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">:</span> ('foo'<span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">,</span> <span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">,</span> <span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">,</span> <span class="token string">'foo'</span><span class="token punctuation">,</span> 'bar')<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><u>对象本身并没有被复制，只是引用了它</u>。</p>
<h5 id="拆分元组"><a href="#拆分元组" class="headerlink" title="拆分元组"></a>拆分元组</h5><p>如果你想将元组赋值给类似元组的变量，<u>Python会试图拆分等号右边的值</u>：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">:</span> tup = (4<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> 6)
In <span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c = tup
In <span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">:</span> b
Out<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">5</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>即使含有元组的元组也会被拆分：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token punctuation">:</span> tup = 4<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> (6<span class="token punctuation">,</span> 7)
In <span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> (c<span class="token punctuation">,</span> d) = tup
In <span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">:</span> d
Out<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">7</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>使用这个功能，你可以很容易地替换变量的名字，其它语言可能是这样：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">tmp = a
a = b
b = tmp<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>但是在<u>Python中，替换</u>可以这样做：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a<span class="token punctuation">,</span> b = 1<span class="token punctuation">,</span> <span class="token number">2</span>
In <span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a
Out<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">1</span>
In <span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token punctuation">:</span> b
Out<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">2</span>
In <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">:</span> b<span class="token punctuation">,</span> a = a<span class="token punctuation">,</span> b
In <span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a
Out<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">2</span>
In <span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">:</span> b
Out<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>变量拆分常用来迭代元组或列表序列：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token punctuation">:</span> seq = <span class="token punctuation">[</span>(1<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> 3)<span class="token punctuation">,</span> (4<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> 6)<span class="token punctuation">,</span> (7<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> 9)<span class="token punctuation">]</span>
In <span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">:</span> for a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token key atrule">c in seq</span><span class="token punctuation">:</span>
<span class="token key atrule">....</span><span class="token punctuation">:</span>     print('a=<span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span> b=<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span> c=<span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">}</span>'.format(a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c))
a=1<span class="token punctuation">,</span> b=2<span class="token punctuation">,</span> c=3
a=4<span class="token punctuation">,</span> b=5<span class="token punctuation">,</span> c=6
a=7<span class="token punctuation">,</span> b=8<span class="token punctuation">,</span> c=9<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>format的用法参考<a target="_blank" rel="noopener" href="https://www.cnblogs.com/lovejh/p/9201219.html">python格式化输出之format用法</a></p>
<p>format基本用法参考</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span> print('<span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>'.format('hello'<span class="token punctuation">,</span>'world'))  <span class="token comment"># 不带字段</span>
hello world
<span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span> print('<span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span>'.format('hello'<span class="token punctuation">,</span>'world'))  <span class="token comment"># 带数字编号</span>
hello world
<span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span> print('<span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span>'.format('hello'<span class="token punctuation">,</span>'world'))  <span class="token comment"># 打乱顺序</span>
hello world hello
<span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span> print('<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span>'.format('hello'<span class="token punctuation">,</span>'world'))
world world hello
<span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span> print('<span class="token punctuation">{</span>a<span class="token punctuation">}</span> <span class="token punctuation">{</span>tom<span class="token punctuation">}</span> <span class="token punctuation">{</span>a<span class="token punctuation">}</span>'.format(tom='hello'<span class="token punctuation">,</span>a='world'))  <span class="token comment"># 带关键字</span>
world hello world<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>另一个常见用法是从函数返回多个值。后面会详解。</p>
<p>Python最近新增了更多高级的元组拆分功能，允许从元组的开头“摘取”几个元素。它使用了特殊的语法*rest，这也用在函数签名中以抓取任意长度列表的位置参数：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token punctuation">:</span> values = 1<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span>
In <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token important">*rest</span> = values
In <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a<span class="token punctuation">,</span> b
Out<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span><span class="token punctuation">:</span> (1<span class="token punctuation">,</span> 2)
In <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">:</span> rest
Out<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>rest的部分是想要舍弃的部分，rest的名字不重要。作为惯用写法，<u>许多Python程序员会将不需要的变量使用下划线</u>：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token important">*_</span> = values<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h5 id="tuple方法"><a href="#tuple方法" class="headerlink" title="tuple方法"></a>tuple方法</h5><p>因为元组的大小和内容不能修改，它的实例方法都很轻量。其中一个很有用的就是count（也适用于列表），它可以统计某个值得出现频率：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a = (1<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> 2)
In <span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a.count(2)
Out<span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">4</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h4 id="列表"><a href="#列表" class="headerlink" title="列表"></a>列表</h4><p>与元组对比(括号定义，不能修改)，<u>列表的长度可变、内容可以被修改。你可以用方括号定义，或用list函数</u>：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a_list = <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> None<span class="token punctuation">]</span>
In <span class="token punctuation">[</span><span class="token number">37</span><span class="token punctuation">]</span><span class="token punctuation">:</span> tup = ('foo'<span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">,</span> 'baz')
In <span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">]</span><span class="token punctuation">:</span> b_list = list(tup)
In <span class="token punctuation">[</span><span class="token number">39</span><span class="token punctuation">]</span><span class="token punctuation">:</span> b_list
Out<span class="token punctuation">[</span><span class="token number">39</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">,</span> <span class="token string">'baz'</span><span class="token punctuation">]</span>
In <span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">:</span> b_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> = 'peekaboo'
In <span class="token punctuation">[</span><span class="token number">41</span><span class="token punctuation">]</span><span class="token punctuation">:</span> b_list
Out<span class="token punctuation">[</span><span class="token number">41</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'peekaboo'</span><span class="token punctuation">,</span> <span class="token string">'baz'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>列表和元组的语义接近，在许多函数中可以交叉使用。</p>
<p>list函数常用来<u>在数据处理中实体化迭代器或生成器</u>：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">42</span><span class="token punctuation">]</span><span class="token punctuation">:</span> gen = range(10)
In <span class="token punctuation">[</span><span class="token number">43</span><span class="token punctuation">]</span><span class="token punctuation">:</span> gen
Out<span class="token punctuation">[</span><span class="token number">43</span><span class="token punctuation">]</span><span class="token punctuation">:</span> range(0<span class="token punctuation">,</span> 10)
In <span class="token punctuation">[</span><span class="token number">44</span><span class="token punctuation">]</span><span class="token punctuation">:</span> list(gen)
Out<span class="token punctuation">[</span><span class="token number">44</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="添加和删除元素"><a href="#添加和删除元素" class="headerlink" title="添加和删除元素"></a>添加和删除元素</h5><p>可以用<u>append</u>在列表末尾添加元素：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">45</span><span class="token punctuation">]</span><span class="token punctuation">:</span> b_list.append('dwarf')
In <span class="token punctuation">[</span><span class="token number">46</span><span class="token punctuation">]</span><span class="token punctuation">:</span> b_list
Out<span class="token punctuation">[</span><span class="token number">46</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'peekaboo'</span><span class="token punctuation">,</span> <span class="token string">'baz'</span><span class="token punctuation">,</span> <span class="token string">'dwarf'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><u>insert</u>可以在特定的位置插入元素：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">47</span><span class="token punctuation">]</span><span class="token punctuation">:</span> b_list.insert(1<span class="token punctuation">,</span> 'red')
In <span class="token punctuation">[</span><span class="token number">48</span><span class="token punctuation">]</span><span class="token punctuation">:</span> b_list
Out<span class="token punctuation">[</span><span class="token number">48</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'red'</span><span class="token punctuation">,</span> <span class="token string">'peekaboo'</span><span class="token punctuation">,</span> <span class="token string">'baz'</span><span class="token punctuation">,</span> <span class="token string">'dwarf'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>插入的序号必须在0和列表长度之间。</p>
<pre><code>警告：与append相比，insert耗费的计算量大，因为对后续元素的引用必须在内部迁移，以便为新元素提供空间。如果要在序列的头部和尾部插入元素，你可能需要使用collections.deque，一个双尾部队列。
</code></pre>
<p>insert的逆运算是<u>pop</u>，它移除并返回指定位置的元素：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">49</span><span class="token punctuation">]</span><span class="token punctuation">:</span> b_list.pop(2)
Out<span class="token punctuation">[</span><span class="token number">49</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'peekaboo'</span>
In <span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">:</span> b_list
Out<span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'red'</span><span class="token punctuation">,</span> <span class="token string">'baz'</span><span class="token punctuation">,</span> <span class="token string">'dwarf'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>可以用remove去除某个值，remove会先寻找第一个值并除去：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">51</span><span class="token punctuation">]</span><span class="token punctuation">:</span> b_list.append('foo')
In <span class="token punctuation">[</span><span class="token number">52</span><span class="token punctuation">]</span><span class="token punctuation">:</span> b_list
Out<span class="token punctuation">[</span><span class="token number">52</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'red'</span><span class="token punctuation">,</span> <span class="token string">'baz'</span><span class="token punctuation">,</span> <span class="token string">'dwarf'</span><span class="token punctuation">,</span> <span class="token string">'foo'</span><span class="token punctuation">]</span>
In <span class="token punctuation">[</span><span class="token number">53</span><span class="token punctuation">]</span><span class="token punctuation">:</span> b_list.remove('foo')
In <span class="token punctuation">[</span><span class="token number">54</span><span class="token punctuation">]</span><span class="token punctuation">:</span> b_list
Out<span class="token punctuation">[</span><span class="token number">54</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">,</span> <span class="token string">'baz'</span><span class="token punctuation">,</span> <span class="token string">'dwarf'</span><span class="token punctuation">,</span> <span class="token string">'foo'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>如果不考虑性能，使用<u>append和remove</u>，可以把Python的列表当做完美的“多重集”数据结构。</p>
<p>用in可以检查列表是否包含某个值：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">55</span><span class="token punctuation">]</span><span class="token punctuation">:</span> 'dwarf' in b_list
Out<span class="token punctuation">[</span><span class="token number">55</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token boolean important">True</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>否定in可以再加一个not：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">56</span><span class="token punctuation">]</span><span class="token punctuation">:</span> 'dwarf' not in b_list
Out<span class="token punctuation">[</span><span class="token number">56</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token boolean important">False</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>在列表中检查是否存在某个值远比字典和集合速度慢，因为Python是线性搜索列表中的值，但在字典和集合中，在同样的时间内还可以检查其它项（基于哈希表）。</p>
<h5 id="串联和组合列表"><a href="#串联和组合列表" class="headerlink" title="串联和组合列表"></a>串联和组合列表</h5><p>与元组类似，可以用加号将两个列表串联起来：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">57</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> None<span class="token punctuation">,</span> <span class="token string">'foo'</span><span class="token punctuation">]</span> + <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> (2<span class="token punctuation">,</span> 3)<span class="token punctuation">]</span>
Out<span class="token punctuation">[</span><span class="token number">57</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> None<span class="token punctuation">,</span> <span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> (2<span class="token punctuation">,</span> 3)<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>如果已经定义了一个列表，用extend方法可以追加多个元素：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">58</span><span class="token punctuation">]</span><span class="token punctuation">:</span> x = <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> None<span class="token punctuation">,</span> <span class="token string">'foo'</span><span class="token punctuation">]</span>
In <span class="token punctuation">[</span><span class="token number">59</span><span class="token punctuation">]</span><span class="token punctuation">:</span> x.extend(<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> (2<span class="token punctuation">,</span> 3)<span class="token punctuation">]</span>)
In <span class="token punctuation">[</span><span class="token number">60</span><span class="token punctuation">]</span><span class="token punctuation">:</span> x
Out<span class="token punctuation">[</span><span class="token number">60</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> None<span class="token punctuation">,</span> <span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> (2<span class="token punctuation">,</span> 3)<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>通过加法将列表串联的计算量较大，因为要新建一个列表，并且要复制对象。用extend追加元素，尤其是到一个大列表中，更为可取。因此：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">everything = <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token key atrule">for chunk in list_of_lists</span><span class="token punctuation">:</span>
    everything.extend(chunk)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>要比串联方法快：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">everything = <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token key atrule">for chunk in list_of_lists</span><span class="token punctuation">:</span>
    everything = everything + chunk<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h5 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h5><p>你可以用<u>sort函数</u>将一个列表原地排序（不创建新的对象）：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">61</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a = <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
In <span class="token punctuation">[</span><span class="token number">62</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a.sort()
In <span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a
Out<span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>sort有一些选项，有时会很好用。其中之一是<u>二级排序key</u>，可以用这个key进行排序。例如，我们可以按长度对字符串进行排序：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">:</span> b = <span class="token punctuation">[</span><span class="token string">'saw'</span><span class="token punctuation">,</span> <span class="token string">'small'</span><span class="token punctuation">,</span> <span class="token string">'He'</span><span class="token punctuation">,</span> <span class="token string">'foxes'</span><span class="token punctuation">,</span> <span class="token string">'six'</span><span class="token punctuation">]</span>
In <span class="token punctuation">[</span><span class="token number">65</span><span class="token punctuation">]</span><span class="token punctuation">:</span> b.sort(key=len)
In <span class="token punctuation">[</span><span class="token number">66</span><span class="token punctuation">]</span><span class="token punctuation">:</span> b
Out<span class="token punctuation">[</span><span class="token number">66</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'He'</span><span class="token punctuation">,</span> <span class="token string">'saw'</span><span class="token punctuation">,</span> <span class="token string">'six'</span><span class="token punctuation">,</span> <span class="token string">'small'</span><span class="token punctuation">,</span> <span class="token string">'foxes'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>稍后，我们会学习sorted函数，它可以产生一个排好序的序列副本。</p>
<h5 id="二分搜索和维护已排序的列表"><a href="#二分搜索和维护已排序的列表" class="headerlink" title="二分搜索和维护已排序的列表"></a>二分搜索和维护已排序的列表</h5><p><u>bisect模块支持二分查找</u>，和向已排序的列表插入值。bisect.bisect可以找到插入值后仍保证排序的位置，bisect.insort是向这个位置插入值：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">67</span><span class="token punctuation">]</span><span class="token punctuation">:</span> import bisect
In <span class="token punctuation">[</span><span class="token number">68</span><span class="token punctuation">]</span><span class="token punctuation">:</span> c = <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span>
In <span class="token punctuation">[</span><span class="token number">69</span><span class="token punctuation">]</span><span class="token punctuation">:</span> bisect.bisect(c<span class="token punctuation">,</span> 2)
Out<span class="token punctuation">[</span><span class="token number">69</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">4</span>
In <span class="token punctuation">[</span><span class="token number">70</span><span class="token punctuation">]</span><span class="token punctuation">:</span> bisect.bisect(c<span class="token punctuation">,</span> 5)
Out<span class="token punctuation">[</span><span class="token number">70</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">6</span>
In <span class="token punctuation">[</span><span class="token number">71</span><span class="token punctuation">]</span><span class="token punctuation">:</span> bisect.insort(c<span class="token punctuation">,</span> 6)
In <span class="token punctuation">[</span><span class="token number">72</span><span class="token punctuation">]</span><span class="token punctuation">:</span> c
Out<span class="token punctuation">[</span><span class="token number">72</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span>

注意：bisect模块不会检查列表是否已排好序，进行检查的话会耗费大量计算。因此，对未排序的列表使用bisect不会产生错误，但结果不一定正确。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="切片"><a href="#切片" class="headerlink" title="切片"></a>切片</h5><p>用切边可以选取大多数序列类型的一部分，<u>切片的基本形式是在方括号中使用start:stop</u>：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">73</span><span class="token punctuation">]</span><span class="token punctuation">:</span> seq = <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
In <span class="token punctuation">[</span><span class="token number">74</span><span class="token punctuation">]</span><span class="token punctuation">:</span> seq<span class="token punctuation">[</span>1<span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span>
Out<span class="token punctuation">[</span><span class="token number">74</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>切片也可以被序列赋值：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">75</span><span class="token punctuation">]</span><span class="token punctuation">:</span> seq<span class="token punctuation">[</span>3<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span> = <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
In <span class="token punctuation">[</span><span class="token number">76</span><span class="token punctuation">]</span><span class="token punctuation">:</span> seq
Out<span class="token punctuation">[</span><span class="token number">76</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>切片的起始元素是包括的，<u>不包含结束元素</u>。因此，结果中包含的<u>元素个数是stop - start</u>。</p>
<p><u>start或stop都可以被省略，省略之后，分别默认序列的开头和结尾</u>：</p>
<pre><code>In [77]: seq[:5]
Out[77]: [7, 2, 3, 6, 3]
In [78]: seq[3:]
Out[78]: [6, 3, 5, 6, 0, 1]
</code></pre>
<p><u>负数表明从后向前切片</u>：</p>
<pre><code>In [79]: seq[-4:]
Out[79]: [5, 6, 0, 1]
In [80]: seq[-6:-2]
Out[80]: [6, 3, 5, 6]
</code></pre>
<p>需要一段时间来熟悉使用切片，尤其是当你之前学的是R或MATLAB。下图展示了正整数和负整数的切片。在图中，指数标示在边缘以表明切片是在哪里开始哪里结束的。</p>
<p><img src="https://tva1.sinaimg.cn/large/007mx13gly1guo30xjryij60yg0eswir02.jpg" alt="Python切片演示"></p>
<p>在<u>第二个冒号</u>后面使用<u>step</u>，可以隔一个取一个元素：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">81</span><span class="token punctuation">]</span><span class="token punctuation">:</span> seq<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>
Out<span class="token punctuation">[</span><span class="token number">81</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>一个聪明的方法是<u>使用-1，它可以将列表或元组颠倒过来</u>：</p>
<pre><code>In [82]: seq[::-1]
Out[82]: [1, 0, 6, 5, 3, 6, 3, 2, 7]
</code></pre>
<h4 id="序列函数"><a href="#序列函数" class="headerlink" title="序列函数"></a>序列函数</h4><p>Python有一些有用的序列函数。</p>
<h5 id="enumerate函数"><a href="#enumerate函数" class="headerlink" title="enumerate函数"></a>enumerate函数</h5><p>迭代一个序列时，你可能想跟踪当前项的序号。手动的方法可能是下面这样：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">i = 0
<span class="token key atrule">for value in collection</span><span class="token punctuation">:</span>
   <span class="token comment"># do something with value</span>
   i += 1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>因为这么做很常见，Python内建了一个enumerate函数，可以返回(i, value)元组序列：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">for i<span class="token punctuation">,</span> <span class="token key atrule">value in enumerate(collection)</span><span class="token punctuation">:</span>
   <span class="token comment"># do something with value</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>当你索引数据时，使用enumerate的一个好方法是计算序列（唯一的）dict映射到位置的值：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">83</span><span class="token punctuation">]</span><span class="token punctuation">:</span> some_list = <span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">,</span> <span class="token string">'baz'</span><span class="token punctuation">]</span>
In <span class="token punctuation">[</span><span class="token number">84</span><span class="token punctuation">]</span><span class="token punctuation">:</span> mapping = <span class="token punctuation">{</span><span class="token punctuation">}</span>
In <span class="token punctuation">[</span><span class="token number">85</span><span class="token punctuation">]</span><span class="token punctuation">:</span> for i<span class="token punctuation">,</span> <span class="token key atrule">v in enumerate(some_list)</span><span class="token punctuation">:</span>
   <span class="token key atrule">....</span><span class="token punctuation">:</span>     mapping<span class="token punctuation">[</span>v<span class="token punctuation">]</span> = i
In <span class="token punctuation">[</span><span class="token number">86</span><span class="token punctuation">]</span><span class="token punctuation">:</span> mapping
Out<span class="token punctuation">[</span><span class="token number">86</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token key atrule">'bar'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token key atrule">'baz'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token key atrule">'foo'</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="sorted函数"><a href="#sorted函数" class="headerlink" title="sorted函数"></a>sorted函数</h5><p>sorted函数可以从任意序列的元素返回一个新的排好序的列表：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">87</span><span class="token punctuation">]</span><span class="token punctuation">:</span> sorted(<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>)
Out<span class="token punctuation">[</span><span class="token number">87</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span>
In <span class="token punctuation">[</span><span class="token number">88</span><span class="token punctuation">]</span><span class="token punctuation">:</span> sorted('horse race')
Out<span class="token punctuation">[</span><span class="token number">88</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">' '</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'e'</span><span class="token punctuation">,</span> <span class="token string">'e'</span><span class="token punctuation">,</span> <span class="token string">'h'</span><span class="token punctuation">,</span> <span class="token string">'o'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> <span class="token string">'s'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><u>sorted函数可以接受和sort相同的参数。</u></p>
<h5 id="zip函数"><a href="#zip函数" class="headerlink" title="zip函数"></a>zip函数</h5><p><u>zip可以将多个列表、元组或其它序列成对组合成一个元组列表</u>：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">89</span><span class="token punctuation">]</span><span class="token punctuation">:</span> seq1 = <span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">,</span> <span class="token string">'baz'</span><span class="token punctuation">]</span>
In <span class="token punctuation">[</span><span class="token number">90</span><span class="token punctuation">]</span><span class="token punctuation">:</span> seq2 = <span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">,</span> <span class="token string">'three'</span><span class="token punctuation">]</span>
In <span class="token punctuation">[</span><span class="token number">91</span><span class="token punctuation">]</span><span class="token punctuation">:</span> zipped = zip(seq1<span class="token punctuation">,</span> seq2)
In <span class="token punctuation">[</span><span class="token number">92</span><span class="token punctuation">]</span><span class="token punctuation">:</span> list(zipped)
Out<span class="token punctuation">[</span><span class="token number">92</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>('foo'<span class="token punctuation">,</span> 'one')<span class="token punctuation">,</span> ('bar'<span class="token punctuation">,</span> 'two')<span class="token punctuation">,</span> ('baz'<span class="token punctuation">,</span> 'three')<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>zip可以处理任意多的序列，元素的个数取决于最短的序列：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">93</span><span class="token punctuation">]</span><span class="token punctuation">:</span> seq3 = <span class="token punctuation">[</span><span class="token boolean important">False</span><span class="token punctuation">,</span> <span class="token boolean important">True</span><span class="token punctuation">]</span>
In <span class="token punctuation">[</span><span class="token number">94</span><span class="token punctuation">]</span><span class="token punctuation">:</span> list(zip(seq1<span class="token punctuation">,</span> seq2<span class="token punctuation">,</span> seq3))
Out<span class="token punctuation">[</span><span class="token number">94</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>('foo'<span class="token punctuation">,</span> <span class="token string">'one'</span><span class="token punctuation">,</span> False)<span class="token punctuation">,</span> ('bar'<span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">,</span> True)<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>zip的常见用法之一是同时迭代多个序列，可能结合enumerate使用：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">95</span><span class="token punctuation">]</span><span class="token punctuation">:</span> for i<span class="token punctuation">,</span> (a<span class="token punctuation">,</span> b) in enumerate(zip(seq1<span class="token punctuation">,</span> <span class="token key atrule">seq2))</span><span class="token punctuation">:</span>
   <span class="token key atrule">....</span><span class="token punctuation">:</span>     print('<span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">}</span>'.format(i<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b))
   <span class="token key atrule">....</span><span class="token punctuation">:</span>
<span class="token key atrule">0</span><span class="token punctuation">:</span> foo<span class="token punctuation">,</span> one
<span class="token key atrule">1</span><span class="token punctuation">:</span> bar<span class="token punctuation">,</span> two
<span class="token key atrule">2</span><span class="token punctuation">:</span> baz<span class="token punctuation">,</span> three<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>给出一个“被压缩的”序列，zip可以被用来解压序列。也可以当作把行的列表转换为列的列表。这个方法看起来有点神奇：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">96</span><span class="token punctuation">]</span><span class="token punctuation">:</span> pitchers = <span class="token punctuation">[</span>('Nolan'<span class="token punctuation">,</span> 'Ryan')<span class="token punctuation">,</span> ('Roger'<span class="token punctuation">,</span> 'Clemens')<span class="token punctuation">,</span>
   <span class="token key atrule">....</span><span class="token punctuation">:</span>             ('Schilling'<span class="token punctuation">,</span> 'Curt')<span class="token punctuation">]</span>
In <span class="token punctuation">[</span><span class="token number">97</span><span class="token punctuation">]</span><span class="token punctuation">:</span> first_names<span class="token punctuation">,</span> last_names = zip(<span class="token important">*pitchers)</span>
In <span class="token punctuation">[</span><span class="token number">98</span><span class="token punctuation">]</span><span class="token punctuation">:</span> first_names
Out<span class="token punctuation">[</span><span class="token number">98</span><span class="token punctuation">]</span><span class="token punctuation">:</span> ('Nolan'<span class="token punctuation">,</span> <span class="token string">'Roger'</span><span class="token punctuation">,</span> 'Schilling')
In <span class="token punctuation">[</span><span class="token number">99</span><span class="token punctuation">]</span><span class="token punctuation">:</span> last_names
Out<span class="token punctuation">[</span><span class="token number">99</span><span class="token punctuation">]</span><span class="token punctuation">:</span> ('Ryan'<span class="token punctuation">,</span> <span class="token string">'Clemens'</span><span class="token punctuation">,</span> 'Curt')<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="reversed函数"><a href="#reversed函数" class="headerlink" title="reversed函数"></a>reversed函数</h5><p>reversed可以<u>从后向前迭代一个序列</u>：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">:</span> list(reversed(range(10)))
Out<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>要记住<u>reversed是一个生成器</u>（后面详细介绍），只有<u>实体化（即列表或for循环）之后才能创建翻转的序列</u>。</p>
<h4 id="字典"><a href="#字典" class="headerlink" title="字典"></a>字典</h4><p>字典可能是Python最为重要的数据结构。它更为常见的名字是<u>哈希映射或关联数组</u>。它是<u>键值对的大小可变集合</u>，键和值都是Python对象。<u>创建字典的方法之一是使用尖括号，用冒号分隔键和值</u>：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">101</span><span class="token punctuation">]</span><span class="token punctuation">:</span> empty_dict = <span class="token punctuation">{</span><span class="token punctuation">}</span>
In <span class="token punctuation">[</span><span class="token number">102</span><span class="token punctuation">]</span><span class="token punctuation">:</span> d1 = <span class="token punctuation">{</span><span class="token key atrule">'a'</span> <span class="token punctuation">:</span> <span class="token string">'some value'</span><span class="token punctuation">,</span> <span class="token key atrule">'b'</span> <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
In <span class="token punctuation">[</span><span class="token number">103</span><span class="token punctuation">]</span><span class="token punctuation">:</span> d1
Out<span class="token punctuation">[</span><span class="token number">103</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token key atrule">'a'</span><span class="token punctuation">:</span> <span class="token string">'some value'</span><span class="token punctuation">,</span> <span class="token key atrule">'b'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>你可以像访问<u>列表或元组中的元素一样，访问、插入或设定字典中的元素</u>：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">104</span><span class="token punctuation">]</span><span class="token punctuation">:</span> d1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> = 'an integer'
In <span class="token punctuation">[</span><span class="token number">105</span><span class="token punctuation">]</span><span class="token punctuation">:</span> d1
Out<span class="token punctuation">[</span><span class="token number">105</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token key atrule">'a'</span><span class="token punctuation">:</span> <span class="token string">'some value'</span><span class="token punctuation">,</span> <span class="token key atrule">'b'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token key atrule">7</span><span class="token punctuation">:</span> <span class="token string">'an integer'</span><span class="token punctuation">}</span>
In <span class="token punctuation">[</span><span class="token number">106</span><span class="token punctuation">]</span><span class="token punctuation">:</span> d1<span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">]</span>
Out<span class="token punctuation">[</span><span class="token number">106</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>你可以用<u>检查列表和元组是否包含某个值的方法，检查字典中是否包含某个键</u>：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">107</span><span class="token punctuation">]</span><span class="token punctuation">:</span> 'b' in d1
Out<span class="token punctuation">[</span><span class="token number">107</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token boolean important">True</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>可以用del关键字或pop方法（返回值的同时删除键）删除值：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">108</span><span class="token punctuation">]</span><span class="token punctuation">:</span> d1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> = 'some value'
In <span class="token punctuation">[</span><span class="token number">109</span><span class="token punctuation">]</span><span class="token punctuation">:</span> d1
Out<span class="token punctuation">[</span><span class="token number">109</span><span class="token punctuation">]</span><span class="token punctuation">:</span> 
<span class="token punctuation">{</span><span class="token key atrule">'a'</span><span class="token punctuation">:</span> <span class="token string">'some value'</span><span class="token punctuation">,</span>
 <span class="token key atrule">'b'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
 <span class="token key atrule">7</span><span class="token punctuation">:</span> <span class="token string">'an integer'</span><span class="token punctuation">,</span>
 <span class="token key atrule">5</span><span class="token punctuation">:</span> <span class="token string">'some value'</span><span class="token punctuation">}</span>
In <span class="token punctuation">[</span><span class="token number">110</span><span class="token punctuation">]</span><span class="token punctuation">:</span> d1<span class="token punctuation">[</span><span class="token string">'dummy'</span><span class="token punctuation">]</span> = 'another value'
In <span class="token punctuation">[</span><span class="token number">111</span><span class="token punctuation">]</span><span class="token punctuation">:</span> d1
Out<span class="token punctuation">[</span><span class="token number">111</span><span class="token punctuation">]</span><span class="token punctuation">:</span> 
<span class="token punctuation">{</span><span class="token key atrule">'a'</span><span class="token punctuation">:</span> <span class="token string">'some value'</span><span class="token punctuation">,</span>
 <span class="token key atrule">'b'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
 <span class="token key atrule">7</span><span class="token punctuation">:</span> <span class="token string">'an integer'</span><span class="token punctuation">,</span>
 <span class="token key atrule">5</span><span class="token punctuation">:</span> <span class="token string">'some value'</span><span class="token punctuation">,</span>
 <span class="token key atrule">'dummy'</span><span class="token punctuation">:</span> <span class="token string">'another value'</span><span class="token punctuation">}</span>
In <span class="token punctuation">[</span><span class="token number">112</span><span class="token punctuation">]</span><span class="token punctuation">:</span> del d1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span>
In <span class="token punctuation">[</span><span class="token number">113</span><span class="token punctuation">]</span><span class="token punctuation">:</span> d1
Out<span class="token punctuation">[</span><span class="token number">113</span><span class="token punctuation">]</span><span class="token punctuation">:</span> 
<span class="token punctuation">{</span><span class="token key atrule">'a'</span><span class="token punctuation">:</span> <span class="token string">'some value'</span><span class="token punctuation">,</span>
 <span class="token key atrule">'b'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
 <span class="token key atrule">7</span><span class="token punctuation">:</span> <span class="token string">'an integer'</span><span class="token punctuation">,</span>
 <span class="token key atrule">'dummy'</span><span class="token punctuation">:</span> <span class="token string">'another value'</span><span class="token punctuation">}</span>
In <span class="token punctuation">[</span><span class="token number">114</span><span class="token punctuation">]</span><span class="token punctuation">:</span> ret = d1.pop('dummy')
In <span class="token punctuation">[</span><span class="token number">115</span><span class="token punctuation">]</span><span class="token punctuation">:</span> ret
Out<span class="token punctuation">[</span><span class="token number">115</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'another value'</span>
In <span class="token punctuation">[</span><span class="token number">116</span><span class="token punctuation">]</span><span class="token punctuation">:</span> d1
Out<span class="token punctuation">[</span><span class="token number">116</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token key atrule">'a'</span><span class="token punctuation">:</span> <span class="token string">'some value'</span><span class="token punctuation">,</span> <span class="token key atrule">'b'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token key atrule">7</span><span class="token punctuation">:</span> <span class="token string">'an integer'</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><u>keys和values是字典的键和值的迭代器方法</u>。虽然键值对没有顺序，这两个方法可以用相同的顺序输出键和值：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">117</span><span class="token punctuation">]</span><span class="token punctuation">:</span> list(d1.keys())
Out<span class="token punctuation">[</span><span class="token number">117</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span>
In <span class="token punctuation">[</span><span class="token number">118</span><span class="token punctuation">]</span><span class="token punctuation">:</span> list(d1.values())
Out<span class="token punctuation">[</span><span class="token number">118</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'some value'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'an integer'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>用update方法可以将一个字典与另一个融合：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">119</span><span class="token punctuation">]</span><span class="token punctuation">:</span> d1.update(<span class="token punctuation">{</span><span class="token key atrule">'b'</span> <span class="token punctuation">:</span> <span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token key atrule">'c'</span> <span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">}</span>)
In <span class="token punctuation">[</span><span class="token number">120</span><span class="token punctuation">]</span><span class="token punctuation">:</span> d1
Out<span class="token punctuation">[</span><span class="token number">120</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token key atrule">'a'</span><span class="token punctuation">:</span> <span class="token string">'some value'</span><span class="token punctuation">,</span> <span class="token key atrule">'b'</span><span class="token punctuation">:</span> <span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token key atrule">7</span><span class="token punctuation">:</span> <span class="token string">'an integer'</span><span class="token punctuation">,</span> <span class="token key atrule">'c'</span><span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>update方法是原地改变字典，因此任何传递给update的键的旧的值都会被舍弃。</p>
<h5 id="用序列创建字典"><a href="#用序列创建字典" class="headerlink" title="用序列创建字典"></a>用序列创建字典</h5><p>常常，你可能想将<u>两个序列配对组合成字典</u>。下面是一种写法：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">mapping = <span class="token punctuation">{</span><span class="token punctuation">}</span>
for key<span class="token punctuation">,</span> value in zip(key_list<span class="token punctuation">,</span> <span class="token key atrule">value_list)</span><span class="token punctuation">:</span>
    mapping<span class="token punctuation">[</span>key<span class="token punctuation">]</span> = value<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>因为<u>字典本质上是2元元组的集合</u>，dict可以接受2元元组的列表：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">121</span><span class="token punctuation">]</span><span class="token punctuation">:</span> mapping = dict(zip(range(5)<span class="token punctuation">,</span> reversed(range(5))))
In <span class="token punctuation">[</span><span class="token number">122</span><span class="token punctuation">]</span><span class="token punctuation">:</span> mapping
Out<span class="token punctuation">[</span><span class="token number">122</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token key atrule">0</span><span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token key atrule">1</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token key atrule">2</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token key atrule">3</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token key atrule">4</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h5 id="dict-函数"><a href="#dict-函数" class="headerlink" title="dict() 函数"></a>dict() 函数</h5><p>函数输入输出实例：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token comment">#输入：</span>
dict0 = dict()  <span class="token comment"># 传一个空字典</span>
print('dict0<span class="token punctuation">:</span>'<span class="token punctuation">,</span> dict0)

dict1 = dict(<span class="token punctuation">{</span><span class="token key atrule">'three'</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token key atrule">'four'</span><span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">}</span>)  <span class="token comment"># 传一个字典</span>
print('dict1<span class="token punctuation">:</span>'<span class="token punctuation">,</span> dict1)

dict2 = dict(five=5<span class="token punctuation">,</span> six=6)  <span class="token comment"># 传关键字</span>
print('dict2<span class="token punctuation">:</span>'<span class="token punctuation">,</span> dict2)

dict3 = dict(<span class="token punctuation">[</span>('seven'<span class="token punctuation">,</span> 7)<span class="token punctuation">,</span> ('eight'<span class="token punctuation">,</span> 8)<span class="token punctuation">]</span>)  <span class="token comment"># 传一个包含一个或多个元祖的列表</span>
print('dict3<span class="token punctuation">:</span>'<span class="token punctuation">,</span> dict3)

dict5 = dict(zip(<span class="token punctuation">[</span><span class="token string">'eleven'</span><span class="token punctuation">,</span> <span class="token string">'twelve'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span>))  <span class="token comment"># 传一个zip()函数</span>
print('dict5<span class="token punctuation">:</span>'<span class="token punctuation">,</span> dict5)

<span class="token comment">#输出：</span>
<span class="token key atrule">dict0</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token key atrule">dict1</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token key atrule">'four'</span><span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token key atrule">'three'</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">}</span>
<span class="token key atrule">dict2</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token key atrule">'five'</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token key atrule">'six'</span><span class="token punctuation">:</span> <span class="token number">6</span><span class="token punctuation">}</span>
<span class="token key atrule">dict3</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token key atrule">'seven'</span><span class="token punctuation">:</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token key atrule">'eight'</span><span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">}</span>
<span class="token key atrule">dict5</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token key atrule">'twelve'</span><span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token key atrule">'eleven'</span><span class="token punctuation">:</span> <span class="token number">11</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>后面会谈到dict comprehensions，另一种构建字典的优雅方式。<br>默认值</p>
<p>下面的逻辑很常见：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">if key in some_dict</span><span class="token punctuation">:</span>
    value = some_dict<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
<span class="token key atrule">else</span><span class="token punctuation">:</span>
    value = default_value<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>因此，dict的方法get和pop可以取默认值进行返回，上面的if-else语句可以简写成下面：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">value = some_dict.get(key<span class="token punctuation">,</span> default_value)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>get默认会返回None，如果不存在键，pop会抛出一个例外。关于设定值，常见的情况是在字典的值是属于其它集合，如列表。例如，你可以通过首字母，将一个列表中的单词分类：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">123</span><span class="token punctuation">]</span><span class="token punctuation">:</span> words = <span class="token punctuation">[</span><span class="token string">'apple'</span><span class="token punctuation">,</span> <span class="token string">'bat'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">,</span> <span class="token string">'atom'</span><span class="token punctuation">,</span> <span class="token string">'book'</span><span class="token punctuation">]</span>
In <span class="token punctuation">[</span><span class="token number">124</span><span class="token punctuation">]</span><span class="token punctuation">:</span> by_letter = <span class="token punctuation">{</span><span class="token punctuation">}</span>
In <span class="token punctuation">[</span><span class="token number">125</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token key atrule">for word in words</span><span class="token punctuation">:</span>
   <span class="token key atrule">.....</span><span class="token punctuation">:</span>     letter = word<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
   <span class="token key atrule">.....</span><span class="token punctuation">:</span>     <span class="token key atrule">if letter not in by_letter</span><span class="token punctuation">:</span>
   <span class="token key atrule">.....</span><span class="token punctuation">:</span>         by_letter<span class="token punctuation">[</span>letter<span class="token punctuation">]</span> = <span class="token punctuation">[</span>word<span class="token punctuation">]</span>
   <span class="token key atrule">.....</span><span class="token punctuation">:</span>     <span class="token key atrule">else</span><span class="token punctuation">:</span>
   <span class="token key atrule">.....</span><span class="token punctuation">:</span>         by_letter<span class="token punctuation">[</span>letter<span class="token punctuation">]</span>.append(word)
   <span class="token key atrule">.....</span><span class="token punctuation">:</span>
In <span class="token punctuation">[</span><span class="token number">126</span><span class="token punctuation">]</span><span class="token punctuation">:</span> by_letter
Out<span class="token punctuation">[</span><span class="token number">126</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token key atrule">'a'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'apple'</span><span class="token punctuation">,</span> <span class="token string">'atom'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token key atrule">'b'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'bat'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">,</span> <span class="token string">'book'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>setdefault方法就正是用于单词分类。前面的for循环可以改写为：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">for word in words</span><span class="token punctuation">:</span>
    letter = word<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    by_letter.setdefault(letter<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>).append(word)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>collections模块有一个很有用的类，defaultdict，它可以进一步简化上面。传递类型或函数以生成每个位置的默认值：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">from collections import defaultdict
by_letter = defaultdict(list)
<span class="token key atrule">for word in words</span><span class="token punctuation">:</span>
    by_letter<span class="token punctuation">[</span>word<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span>.append(word)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="如何使用defaultdict"><a href="#如何使用defaultdict" class="headerlink" title="如何使用defaultdict"></a>如何使用defaultdict</h5><p>defaultdict接受一个工厂函数作为参数，如下来构造：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">dict =defaultdict( factory_function)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>这个factory_function可以是list、set、str等等，作用是当key不存在时，返回的是工厂函数的默认值，比如list对应[ ]，str对应的是空字符串，set对应set( )，int对应0，如下举例：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">from collections import defaultdict

dict1 = defaultdict(int)
dict2 = defaultdict(set)
dict3 = defaultdict(str)
dict4 = defaultdict(list)
dict1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> ='two'

print(dict1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>)
print(dict2<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>)
print(dict3<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>)
print(dict4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>)
<span class="token comment">#输出为</span>
0
set()

<span class="token punctuation">[</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="有效的键类型"><a href="#有效的键类型" class="headerlink" title="有效的键类型"></a>有效的键类型</h5><p>字典的值可以是任意Python对象，而键通常是不可变的标量类型（<u>整数、浮点型、字符串</u>）或<u>元组（元组中的对象必须是不可变的）</u>，这被称为“可哈希性。可以用<u>hash函数可检测一个对象是否是可哈希的</u>（可被用作字典的键）：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">]</span><span class="token punctuation">:</span> hash('string')
Out<span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">5023931463650008331</span>
In <span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span><span class="token punctuation">:</span> hash((1<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> (2<span class="token punctuation">,</span> 3)))
Out<span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">1097636502276347782</span>
In <span class="token punctuation">[</span><span class="token number">129</span><span class="token punctuation">]</span><span class="token punctuation">:</span> hash((1<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>)) <span class="token comment"># fails because lists are mutable</span>
<span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span>
TypeError                                 Traceback (most recent call last)
&lt;ipython<span class="token punctuation">-</span>input<span class="token punctuation">-</span>129<span class="token punctuation">-</span>800cd14ba8be<span class="token punctuation">&gt;</span> in &lt;module<span class="token punctuation">&gt;</span>()
<span class="token punctuation">---</span><span class="token punctuation">-</span><span class="token punctuation">&gt;</span> 1 hash((1<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>)) <span class="token comment"># fails because lists are mutable</span>
<span class="token key atrule">TypeError</span><span class="token punctuation">:</span> <span class="token key atrule">unhashable type</span><span class="token punctuation">:</span> <span class="token string">'list'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>要用列表当做键，一种方法是将列表转化为元组，只要内部元素可以被哈希，它也就可以被哈希：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">130</span><span class="token punctuation">]</span><span class="token punctuation">:</span> d = <span class="token punctuation">{</span><span class="token punctuation">}</span>
In <span class="token punctuation">[</span><span class="token number">131</span><span class="token punctuation">]</span><span class="token punctuation">:</span> d<span class="token punctuation">[</span>tuple(<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>)<span class="token punctuation">]</span> = 5
In <span class="token punctuation">[</span><span class="token number">132</span><span class="token punctuation">]</span><span class="token punctuation">:</span> d
Out<span class="token punctuation">[</span><span class="token number">132</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>(1<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token key atrule">3)</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="集合"><a href="#集合" class="headerlink" title="集合"></a>集合</h4><p>集合是<u>无序的不可重复的元素的集合</u>。你可以把它当做<u>字典，但是只有键没有值</u>。可以用两种方式创建集合：通过set函数或使用尖括号set语句：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">133</span><span class="token punctuation">]</span><span class="token punctuation">:</span> set(<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>)
Out<span class="token punctuation">[</span><span class="token number">133</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span>
In <span class="token punctuation">[</span><span class="token number">134</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span>
Out<span class="token punctuation">[</span><span class="token number">134</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>集合支持<u>合并、交集、差分和对称差等数学集合运算</u>。考虑两个示例集合：</p>
<pre><code>In [135]: a = {1, 2, 3, 4, 5}
In [136]: b = {3, 4, 5, 6, 7, 8}
</code></pre>
<p>合并是取两个集合中不重复的元素。可以用union方法，或者|运算符：</p>
<pre><code>In [137]: a.union(b)
Out[137]: {1, 2, 3, 4, 5, 6, 7, 8}
In [138]: a | b
Out[138]: {1, 2, 3, 4, 5, 6, 7, 8}
</code></pre>
<p>交集的元素包含在两个集合中。可以用intersection或&amp;运算符：</p>
<pre><code>In [139]: a.intersection(b)
Out[139]: {3, 4, 5}
In [140]: a &amp; b
Out[140]: {3, 4, 5}
</code></pre>
<p><img src="https://tva1.sinaimg.cn/large/007mx13gly1guoajywdctj60jb0cj7a902.jpg" alt="常用的集合方法">。</p>
<p>所有逻辑集合操作都有另外的原地实现方法，可以直接用结果替代集合的内容。对于大的集合，这么做效率更高：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">141</span><span class="token punctuation">]</span><span class="token punctuation">:</span> c = a.copy()
In <span class="token punctuation">[</span><span class="token number">142</span><span class="token punctuation">]</span><span class="token punctuation">:</span> c <span class="token punctuation">|</span>= b
In <span class="token punctuation">[</span><span class="token number">143</span><span class="token punctuation">]</span><span class="token punctuation">:</span> c
Out<span class="token punctuation">[</span><span class="token number">143</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">}</span>
In <span class="token punctuation">[</span><span class="token number">144</span><span class="token punctuation">]</span><span class="token punctuation">:</span> d = a.copy()
In <span class="token punctuation">[</span><span class="token number">145</span><span class="token punctuation">]</span><span class="token punctuation">:</span> d <span class="token important">&amp;=</span> b
In <span class="token punctuation">[</span><span class="token number">146</span><span class="token punctuation">]</span><span class="token punctuation">:</span> d
Out<span class="token punctuation">[</span><span class="token number">146</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>与字典类似，<u>集合元素通常都是不可变的</u>。要获得类似列表的元素，必须转换成元组：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">147</span><span class="token punctuation">]</span><span class="token punctuation">:</span> my_data = <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>
In <span class="token punctuation">[</span><span class="token number">148</span><span class="token punctuation">]</span><span class="token punctuation">:</span> my_set = <span class="token punctuation">{</span>tuple(my_data)<span class="token punctuation">}</span>
In <span class="token punctuation">[</span><span class="token number">149</span><span class="token punctuation">]</span><span class="token punctuation">:</span> my_set
Out<span class="token punctuation">[</span><span class="token number">149</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>(1<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> 4)<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>你使用issubset还可以检测一个集合是否是另一个集合的子集或父集：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">150</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a_set = <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span>
In <span class="token punctuation">[</span><span class="token number">151</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span>.issubset(a_set)
Out<span class="token punctuation">[</span><span class="token number">151</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token boolean important">True</span>
In <span class="token punctuation">[</span><span class="token number">152</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a_set.issuperset(<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span>)
Out<span class="token punctuation">[</span><span class="token number">152</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token boolean important">True</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>集合的内容相同时，集合才对等：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">153</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span> == <span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">}</span>
Out<span class="token punctuation">[</span><span class="token number">153</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token boolean important">True</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h4 id="列表、集合和字典推导式"><a href="#列表、集合和字典推导式" class="headerlink" title="列表、集合和字典推导式"></a>列表、集合和字典推导式</h4><p><u>列表推导式</u>是Python最受喜爱的特性之一。它允许用户方便的从一个集合过滤元素，形成列表，在传递参数的过程中还可以修改元素。形式如下：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token punctuation">[</span>expr for val in collection if condition<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>它等同于下面的for循环;</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">result = <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token key atrule">for val in collection</span><span class="token punctuation">:</span>
    <span class="token key atrule">if condition</span><span class="token punctuation">:</span>
        result.append(expr)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>filter条件可以被忽略，只留下表达式就行。例如，给定一个字符串列表，我们可以过滤出长度在2及以下的字符串，并将其转换成大写：</p>
<pre><code>In [154]: strings = ['a', 'as', 'bat', 'car', 'dove', 'python']
In [155]: [x.upper() for x in strings if len(x) &gt; 2]
Out[155]: ['BAT', 'CAR', 'DOVE', 'PYTHON']
</code></pre>
<p>用相似的方法，还可以推导集合和字典。<u>字典的推导式</u>如下所示：</p>
<pre><code>dict_comp = {key-expr : value-expr for value in collection if condition}
</code></pre>
<p><u>集合的推导式</u>与列表很像，只不过用的是<u>尖括号</u>：</p>
<pre><code>set_comp = {expr for value in collection if condition}
</code></pre>
<p>与列表推导式类似，集合与字典的推导也很方便，而且使代码的读写都很容易。来看前面的字符串列表。假如我们只想要字符串的长度，用集合推导式的方法非常方便：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">156</span><span class="token punctuation">]</span><span class="token punctuation">:</span> unique_lengths = <span class="token punctuation">{</span>len(x) for x in strings<span class="token punctuation">}</span>
In <span class="token punctuation">[</span><span class="token number">157</span><span class="token punctuation">]</span><span class="token punctuation">:</span> unique_lengths
Out<span class="token punctuation">[</span><span class="token number">157</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>map函数可以进一步简化：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">158</span><span class="token punctuation">]</span><span class="token punctuation">:</span> set(map(len<span class="token punctuation">,</span> strings))
Out<span class="token punctuation">[</span><span class="token number">158</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>map()是一个 Python 内建函数，它允许你不需要使用循环就可以编写简洁的代码，具体用法参考[Python Map 函数的使用](<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/205466485">Python Map 函数的使用 - 知乎 (zhihu.com)</a>)，基本用法为：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">map(function<span class="token punctuation">,</span> iterable<span class="token punctuation">,</span> <span class="token punctuation">...</span>)
<span class="token comment">#function` - 针对每一个迭代调用的函数</span>
<span class="token comment">#iterable` - 支持迭代的一个或者多个对象。在 Python 中大部分内建对象，例如 lists, dictionaries, 和 tuples 都是可迭代的</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>作为一个字典推导式的例子，我们可以创建一个字符串的查找映射表以确定它在列表中的位置：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">159</span><span class="token punctuation">]</span><span class="token punctuation">:</span> loc_mapping = <span class="token punctuation">{</span><span class="token key atrule">val</span> <span class="token punctuation">:</span> index for index<span class="token punctuation">,</span> val in enumerate(strings)<span class="token punctuation">}</span>
In <span class="token punctuation">[</span><span class="token number">160</span><span class="token punctuation">]</span><span class="token punctuation">:</span> loc_mapping
Out<span class="token punctuation">[</span><span class="token number">160</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token key atrule">'a'</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token key atrule">'as'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token key atrule">'bat'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token key atrule">'car'</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token key atrule">'dove'</span><span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token key atrule">'python'</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h4 id="嵌套列表推导式"><a href="#嵌套列表推导式" class="headerlink" title="嵌套列表推导式"></a>嵌套列表推导式</h4><p>假设我们有一个包含列表的列表，包含了一些英文名和西班牙名：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">161</span><span class="token punctuation">]</span><span class="token punctuation">:</span> all_data = <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'John'</span><span class="token punctuation">,</span> <span class="token string">'Emily'</span><span class="token punctuation">,</span> <span class="token string">'Michael'</span><span class="token punctuation">,</span> <span class="token string">'Mary'</span><span class="token punctuation">,</span> <span class="token string">'Steven'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
   <span class="token key atrule">.....</span><span class="token punctuation">:</span>             <span class="token punctuation">[</span><span class="token string">'Maria'</span><span class="token punctuation">,</span> <span class="token string">'Juan'</span><span class="token punctuation">,</span> <span class="token string">'Javier'</span><span class="token punctuation">,</span> <span class="token string">'Natalia'</span><span class="token punctuation">,</span> <span class="token string">'Pilar'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>你可能是从一些文件得到的这些名字，然后想按照语言进行分类。现在假设我们想用一个列表包含所有的名字，这些名字中包含两个或更多的e。可以用for循环来做：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">names_of_interest = <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token key atrule">for names in all_data</span><span class="token punctuation">:</span>
    enough_es = <span class="token punctuation">[</span>name for name in names if name.count('e') <span class="token punctuation">&gt;</span>= 2<span class="token punctuation">]</span>
    names_of_interest.extend(enough_es)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>可以用嵌套列表推导式的方法，将这些写在一起，如下所示：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">162</span><span class="token punctuation">]</span><span class="token punctuation">:</span> result = <span class="token punctuation">[</span>name for names in all_data for name in names
   <span class="token key atrule">.....</span><span class="token punctuation">:</span>           if name.count('e') <span class="token punctuation">&gt;</span>= 2<span class="token punctuation">]</span>
In <span class="token punctuation">[</span><span class="token number">163</span><span class="token punctuation">]</span><span class="token punctuation">:</span> result
Out<span class="token punctuation">[</span><span class="token number">163</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Steven'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>嵌套列表推导式看起来有些复杂。列表推导式的for部分是根据嵌套的顺序，过滤条件还是放在最后。下面是另一个例子，我们将一个整数元组的列表扁平化成了一个整数列表：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">164</span><span class="token punctuation">]</span><span class="token punctuation">:</span> some_tuples = <span class="token punctuation">[</span>(1<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> 3)<span class="token punctuation">,</span> (4<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> 6)<span class="token punctuation">,</span> (7<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> 9)<span class="token punctuation">]</span>
In <span class="token punctuation">[</span><span class="token number">165</span><span class="token punctuation">]</span><span class="token punctuation">:</span> flattened = <span class="token punctuation">[</span>x for tup in some_tuples for x in tup<span class="token punctuation">]</span>
In <span class="token punctuation">[</span><span class="token number">166</span><span class="token punctuation">]</span><span class="token punctuation">:</span> flattened
Out<span class="token punctuation">[</span><span class="token number">166</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>记住，for表达式的顺序是与嵌套for循环的顺序一样（而不是列表推导式的顺序）：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">flattened = <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token key atrule">for tup in some_tuples</span><span class="token punctuation">:</span>
    <span class="token key atrule">for x in tup</span><span class="token punctuation">:</span>
        flattened.append(x)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>你可以有任意多级别的嵌套，但是如果你有两三个以上的嵌套，你就应该考虑下代码可读性的问题了。分辨列表推导式的列表推导式中的语法也是很重要的：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">167</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>x for x in tup<span class="token punctuation">]</span> for tup in some_tuples<span class="token punctuation">]</span>
Out<span class="token punctuation">[</span><span class="token number">167</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>这段代码产生了一个列表的列表，而不是扁平化的只包含元素的列表。</p>
<h3 id="3-2-函数"><a href="#3-2-函数" class="headerlink" title="3.2 函数"></a><a target="_blank" rel="noopener" href="https://www.bookstack.cn/read/pyda-2e-zh/3.2.md">3.2 函数</a></h3><p>函数是Python中最主要也是最重要的代码组织和复用手段。作为最重要的原则，如果你要重复使用相同或非常类似的代码，就需要写一个函数。通过给函数起一个名字，还可以提高代码的可读性。</p>
<p>函数使用<code>def</code>关键字声明，用<code>return</code>关键字返回值：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">def my_function(x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token key atrule">z=1.5)</span><span class="token punctuation">:</span>
    <span class="token key atrule">if z &gt; 1</span><span class="token punctuation">:</span>
        return z * (x + y)
    <span class="token key atrule">else</span><span class="token punctuation">:</span>
        return z / (x + y)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>同时拥有多条<code>return</code>语句也是可以的。如果到达函数末尾时没有遇到任何一条<code>return</code>语句，则返回<code>None</code>。</p>
<p>函数可以有一些位置参数（<code>positional</code>）和一些关键字参数（<code>keyword</code>）。<u>关键字参数通常用于指定默认值或可选参数</u>。在上面的函数中，<u>x和y是位置参数，而z则是关键字参数</u>。也就是说，该函数可以下面这3种方式进行调用：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">my_function(5<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> z=0.7)
my_function(3.14<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> 3.5)
my_function(10<span class="token punctuation">,</span> 20)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><u>函数参数的主要限制在于：关键字参数必须位于位置参数（如果有的话）之后。</u>你可以任何顺序指定关键字参数。也就是说，你不用死记硬背函数参数的顺序，只要记得它们的名字就可以了。</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token comment">#笔记：也可以用"关键字传递位置参数"。前面的例子，也可以写为：</span>

    my_function(x=5<span class="token punctuation">,</span> y=6<span class="token punctuation">,</span> z=7)
    my_function(y=6<span class="token punctuation">,</span> x=5<span class="token punctuation">,</span> z=7)

<span class="token comment">#这种写法可以提高可读性。</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="命名空间、作用域，和局部函数"><a href="#命名空间、作用域，和局部函数" class="headerlink" title="命名空间、作用域，和局部函数"></a>命名空间、作用域，和局部函数</h4><p>函数可以访问两种不同作用域中的变量：<u>全局（global）和局部（local）</u>。Python有一种更科学的<u>用于描述变量作用域的名称，即命名空间（namespace）</u>。任何<u>在函数中赋值的变量</u>默认都是被分配到<u>局部命名空间</u>（local namespace）中的。局部命名空间是在函数被调用时创建的，函数参数会立即填入该命名空间。在函数执行完毕之后，局部命名空间就会被销毁（会有一些例外的情况，具体请参见后面介绍闭包的那一节）。看看下面这个函数：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">def func()</span><span class="token punctuation">:</span>
    a = <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token key atrule">for i in range(5)</span><span class="token punctuation">:</span>
        a.append(i)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>调用<code>func()</code>之后，首先会创建出空列表a，然后添加5个元素，最后a会在该函数退出的时候被销毁。假如我们像下面这样定义a：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">a = <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token key atrule">def func()</span><span class="token punctuation">:</span>
    <span class="token key atrule">for i in range(5)</span><span class="token punctuation">:</span>
        a.append(i)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>虽然可以在函数中对全局变量进行赋值操作，但是那些变量必须用global关键字声明成全局的才行：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">168</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a = None
In <span class="token punctuation">[</span><span class="token number">169</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token key atrule">def bind_a_variable()</span><span class="token punctuation">:</span>
   <span class="token key atrule">.....</span><span class="token punctuation">:</span>     global a
   <span class="token key atrule">.....</span><span class="token punctuation">:</span>     a = <span class="token punctuation">[</span><span class="token punctuation">]</span>
   <span class="token key atrule">.....</span><span class="token punctuation">:</span> bind_a_variable()
   <span class="token key atrule">.....</span><span class="token punctuation">:</span>
In <span class="token punctuation">[</span><span class="token number">170</span><span class="token punctuation">]</span><span class="token punctuation">:</span> print(a)
<span class="token punctuation">[</span><span class="token punctuation">]</span>

注意：我常常建议人们不要频繁使用global关键字。因为全局变量一般是用于存放系统的某些状态的。如果你发现自己用了很多，那可能就说明得要来点儿面向对象编程了（即使用类）。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="返回多个值"><a href="#返回多个值" class="headerlink" title="返回多个值"></a>返回多个值</h4><p>在我第一次用Python编程时（之前已经习惯了Java和C++），最喜欢的一个功能是：函数可以返回多个值。下面是一个简单的例子：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">def f()</span><span class="token punctuation">:</span>
    a = 5
    b = 6
    c = 7
    return a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c
a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c = f()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在数据分析和其他科学计算应用中，你会发现自己常常这么干。该函数其实只返回了一个对象，也就是一个元组，最后该元组会被拆包到各个结果变量中。在上面的例子中，我们还可以这样写：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">return_value = f()<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>这里的return_value将会是一个含有3个返回值的三元元组。此外，还有一种非常具有吸引力的多值返回方式——返回字典：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">def f()</span><span class="token punctuation">:</span>
    a = 5
    b = 6
    c = 7
    return <span class="token punctuation">{</span><span class="token key atrule">'a'</span> <span class="token punctuation">:</span> a<span class="token punctuation">,</span> <span class="token key atrule">'b'</span> <span class="token punctuation">:</span> b<span class="token punctuation">,</span> <span class="token key atrule">'c'</span> <span class="token punctuation">:</span> c<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>取决于工作内容，第二种方法可能很有用。</p>
<h4 id="函数也是对象"><a href="#函数也是对象" class="headerlink" title="函数也是对象"></a>函数也是对象</h4><p>由于Python函数都是对象(<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/75265007">2分钟让你明白什么是面向对象编程 - 知乎 (zhihu.com)</a>)，因此，在其他语言中较难表达的一些设计思想在Python中就要简单很多了。假设我们有下面这样一个字符串数组，希望对其进行一些数据清理工作并执行一堆转换：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">171</span><span class="token punctuation">]</span><span class="token punctuation">:</span> states = <span class="token punctuation">[</span><span class="token string">'   Alabama '</span><span class="token punctuation">,</span> <span class="token string">'Georgia!'</span><span class="token punctuation">,</span> <span class="token string">'Georgia'</span><span class="token punctuation">,</span> <span class="token string">'georgia'</span><span class="token punctuation">,</span> <span class="token string">'FlOrIda'</span><span class="token punctuation">,</span>
   <span class="token key atrule">.....</span><span class="token punctuation">:</span>           <span class="token string">'south   carolina##'</span><span class="token punctuation">,</span> <span class="token string">'West virginia?'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>不管是谁，只要处理过由用户提交的调查数据，就能明白这种乱七八糟的数据是怎么一回事。为了得到一组能用于分析工作的格式统一的字符串，需要做很多事情：去除空白符、删除各种标点符号、正确的大写格式等。做法之一是使用内建的字符串方法和正则表达式re模块(<a target="_blank" rel="noopener" href="http://www.itwangqing.net.cn/15623206542335.html#:~:text=%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%EF%BC%88RE,%E8%BF%87re%E6%A8%A1%E5%9D%97%E5%AE%9E%E7%8E%B0%E3%80%82">可参考正则表达式re模块 </a>)：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">import re
<span class="token key atrule">def clean_strings(strings)</span><span class="token punctuation">:</span>
    result = <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token key atrule">for value in strings</span><span class="token punctuation">:</span>
        value = value.strip()
        value = re.sub('<span class="token punctuation">[</span><span class="token tag">!</span><span class="token comment">#?]', '', value)</span>
        value = value.title()<span class="token comment">#</span>
        result.append(value)
    return result<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>其中，<code>strip</code>方法的功能为移除字符串头尾指定的字符（默认为空格或换行符）或字符序列。其语法与实例为（可参考<a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-strip.html">Python strip()方法)</a>）：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token comment">#语法</span>
str.strip(<span class="token punctuation">[</span>chars<span class="token punctuation">]</span>);
<span class="token comment">#实例</span>
str = "00000003210Runoob01230000000"; 
print str.strip( '0' );  <span class="token comment"># 去除首尾字符 0</span>

str2 = "   Runoob      ";   <span class="token comment"># 去除首尾空格</span>
print str2.strip();
<span class="token comment">#输出：</span>
3210Runoob0123
Runoob<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>title</code>方法返回”标题化”的字符串,就是说所有单词的首个字母转化为大写，其余字母均为小写，用法为：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">str.title();<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>结果如下所示：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">173</span><span class="token punctuation">]</span><span class="token punctuation">:</span> clean_strings(states)
Out<span class="token punctuation">[</span><span class="token number">173</span><span class="token punctuation">]</span><span class="token punctuation">:</span> 
<span class="token punctuation">[</span><span class="token string">'Alabama'</span><span class="token punctuation">,</span>
 <span class="token string">'Georgia'</span><span class="token punctuation">,</span>
 <span class="token string">'Georgia'</span><span class="token punctuation">,</span>
 <span class="token string">'Georgia'</span><span class="token punctuation">,</span>
 <span class="token string">'Florida'</span><span class="token punctuation">,</span>
 <span class="token string">'South   Carolina'</span><span class="token punctuation">,</span>
 <span class="token string">'West Virginia'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>其实还有另外一种不错的办法：将<u>需要在一组给定字符串上执行的所有运算做成一个列表，再将列表中的运算一个一个执行</u>：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">def remove_punctuation(value)</span><span class="token punctuation">:</span>
    return re.sub('<span class="token punctuation">[</span><span class="token tag">!</span><span class="token comment">#?]', '', value)</span>
clean_ops = <span class="token punctuation">[</span>str.strip<span class="token punctuation">,</span> remove_punctuation<span class="token punctuation">,</span> str.title<span class="token punctuation">]</span>
def clean_strings(strings<span class="token punctuation">,</span> <span class="token key atrule">ops)</span><span class="token punctuation">:</span>
    result = <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token key atrule">for value in strings</span><span class="token punctuation">:</span>
        <span class="token key atrule">for function in ops</span><span class="token punctuation">:</span>
            value = function(value)
        result.append(value)
    return result<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>然后我们就有了：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">175</span><span class="token punctuation">]</span><span class="token punctuation">:</span> clean_strings(states<span class="token punctuation">,</span> clean_ops)
Out<span class="token punctuation">[</span><span class="token number">175</span><span class="token punctuation">]</span><span class="token punctuation">:</span> 
<span class="token punctuation">[</span><span class="token string">'Alabama'</span><span class="token punctuation">,</span>
 <span class="token string">'Georgia'</span><span class="token punctuation">,</span>
 <span class="token string">'Georgia'</span><span class="token punctuation">,</span>
 <span class="token string">'Georgia'</span><span class="token punctuation">,</span>
 <span class="token string">'Florida'</span><span class="token punctuation">,</span>
 <span class="token string">'South   Carolina'</span><span class="token punctuation">,</span>
 <span class="token string">'West Virginia'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这种多函数模式使你能在很高的层次上轻松修改字符串的转换方式。此时的clean_strings也更具可复用性！</p>
<p>还可以将函数用作其他函数的参数，比如内置的<code>map</code>函数，它用于<u>在一组数据上应用一个函数</u>：</p>
<pre><code>In [176]: for x in map(remove_punctuation, states):
   .....:     print(x)
Alabama 
Georgia
Georgia
georgia
FlOrIda
south   carolina
West virginia
</code></pre>
<h4 id="匿名（lambda）函数"><a href="#匿名（lambda）函数" class="headerlink" title="匿名（lambda）函数"></a>匿名（lambda）函数</h4><p>Python支持一种被称为匿名的、或<code>lambda</code>函数。<u>它仅由单条语句组成，该语句的结果就是返回值</u>。它是通过<code>lambda</code>关键字定义的，<u>这个关键字没有别的含义，仅仅是说“我们正在声明的是一个匿名函数”</u>。</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">def short_function(x)</span><span class="token punctuation">:</span>
    return x * 2
<span class="token key atrule">equiv_anon = lambda x</span><span class="token punctuation">:</span> x * 2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>本书其余部分一般将其称为lambda函数。它们在数据分析工作中非常方便，因为你会发现很多数据转换函数都以函数作为参数的。<u>直接传入lambda函数比编写完整函数声明要少输入很多字（也更清晰）</u>，甚至比将<code>lambda</code>函数赋值给一个变量还要少输入很多字。看看下面这个简单得有些傻的例子：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">def apply_to_list(some_list<span class="token punctuation">,</span> <span class="token key atrule">f)</span><span class="token punctuation">:</span>
    return <span class="token punctuation">[</span>f(x) for x in some_list<span class="token punctuation">]</span>
ints = <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span>
apply_to_list(ints<span class="token punctuation">,</span> <span class="token key atrule">lambda x</span><span class="token punctuation">:</span> x * 2)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>虽然你可以直接编写<code>[x *2for x in ints]</code>，但是这里我们可以非常轻松地传入一个自定义运算给apply_to_list函数。</p>
<p>再来看另外一个例子。假设有一组字符串，你想要根据各字符串不同字母的数量对其进行排序：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">177</span><span class="token punctuation">]</span><span class="token punctuation">:</span> strings = <span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'card'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">,</span> <span class="token string">'aaaa'</span><span class="token punctuation">,</span> <span class="token string">'abab'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>这里，我们可以传入一个lambda函数到列表的sort方法：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">178</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token key atrule">strings.sort(key=lambda x</span><span class="token punctuation">:</span> len(set(list(x)))) <span class="token comment">#字符串中的不同的字符数目</span>
In <span class="token punctuation">[</span><span class="token number">179</span><span class="token punctuation">]</span><span class="token punctuation">:</span> strings
Out<span class="token punctuation">[</span><span class="token number">179</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'aaaa'</span><span class="token punctuation">,</span> <span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'abab'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">,</span> <span class="token string">'card'</span><span class="token punctuation">]</span>

<span class="token comment">#笔记：lambda函数之所以会被称为匿名函数，与def声明的函数不同，原因之一就是这种函数对象本身是没有提供名称name属性。</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="柯里化：部分参数应用"><a href="#柯里化：部分参数应用" class="headerlink" title="柯里化：部分参数应用"></a>柯里化：部分参数应用</h4><p>柯里化（currying）是一个有趣的计算机科学术语，它指的是通过“部分参数应用”（partial argument application）从现有函数派生出新函数的技术。例如，假设我们有一个执行两数相加的简单函数：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">def add_numbers(x<span class="token punctuation">,</span> <span class="token key atrule">y)</span><span class="token punctuation">:</span>
    return x + y<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>通过这个函数，我们可以派生出一个新的只有一个参数的函数——add_five，它用于对其参数加5：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">add_five = lambda y</span><span class="token punctuation">:</span> add_numbers(5<span class="token punctuation">,</span> y)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>add_numbers的第二个参数称为“柯里化的”（curried）。这里没什么特别花哨的东西，因为我们其实就只是定义了一个可以调用现有函数的新函数而已。内置的<code>functools</code>模块可以用partial函数将此过程简化：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">from functools import partial
add_five = partial(add_numbers<span class="token punctuation">,</span> 5)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h4 id="生成器"><a href="#生成器" class="headerlink" title="生成器"></a>生成器</h4><p>能以一种一致的方式对序列进行迭代（比如列表中的对象或文件中的行）是Python的一个重要特点。这是通过一种叫做迭代器协议（iterator protocol，它是一种使对象可迭代的通用方式）的方式实现的，一个原生的使对象可迭代的方法。比如说，对字典进行迭代可以得到其所有的键：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">180</span><span class="token punctuation">]</span><span class="token punctuation">:</span> some_dict = <span class="token punctuation">{</span><span class="token key atrule">'a'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token key atrule">'b'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token key atrule">'c'</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">}</span>
In <span class="token punctuation">[</span><span class="token number">181</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token key atrule">for key in some_dict</span><span class="token punctuation">:</span>
   <span class="token key atrule">.....</span><span class="token punctuation">:</span>     print(key)
a
b
c<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>当你编写<code>for key in some_dict</code>时，Python解释器首先会尝试从some_dict创建一个迭代器：</p>
<pre><code>In [182]: dict_iterator = iter(some_dict)
In [183]: dict_iterator
Out[183]: &lt;dict_keyiterator at 0x7fbbd5a9f908&gt;
</code></pre>
<p>迭代器是一种特殊对象，它可以在诸如for循环之类的上下文中向Python解释器输送对象。大部分能接受列表之类的对象的方法也都可以接受任何可迭代对象。比如<code>min、max、sum</code>等内置方法以及<code>list、tuple</code>等类型构造器：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">184</span><span class="token punctuation">]</span><span class="token punctuation">:</span> list(dict_iterator)
Out<span class="token punctuation">[</span><span class="token number">184</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>生成器（generator）是构造新的可迭代对象的一种简单方式。一般的函数执行之后只会返回单个值，而生成器则是<u>以延迟的方式返回一个值序列，即每返回一个值之后暂停，直到下一个值被请求时再继续</u>。要创建一个生成器，只需将函数中的<code>return</code>替换为<code>yeild</code>即可：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">def squares(n=10)</span><span class="token punctuation">:</span>
    print('Generating squares from 1 to <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span>'.format(n <span class="token important">**</span> 2))
    for i in range(1<span class="token punctuation">,</span> <span class="token key atrule">n + 1)</span><span class="token punctuation">:</span>
        yield i <span class="token important">**</span> 2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>调用该生成器时，没有任何代码会被立即执行：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">186</span><span class="token punctuation">]</span><span class="token punctuation">:</span> gen = squares()
In <span class="token punctuation">[</span><span class="token number">187</span><span class="token punctuation">]</span><span class="token punctuation">:</span> gen
Out<span class="token punctuation">[</span><span class="token number">187</span><span class="token punctuation">]</span><span class="token punctuation">:</span> &lt;generator object squares at 0x7fbbd5ab4570<span class="token punctuation">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>直到你从<u>该生成器中请求元素</u>时，它才会开始执行其代码：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">188</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token key atrule">for x in gen</span><span class="token punctuation">:</span>
   <span class="token key atrule">.....</span><span class="token punctuation">:</span>     print(x<span class="token punctuation">,</span> end=' ')
Generating squares from 1 to 100
1 4 9 16 25 36 49 64 81 100<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="生成器表达式"><a href="#生成器表达式" class="headerlink" title="生成器表达式"></a>生成器表达式</h5><p>另一种更简洁的构造生成器的方法是使用生成器表达式（generator expression）。<u>这是一种类似于列表、字典、集合推导式的生成器。其创建方式为，把列表推导式两端的方括号改成圆括号</u>：</p>
<pre><code>In [189]: gen = (x ** 2 for x in range(100))
In [190]: gen
Out[190]: &lt;generator object &lt;genexpr&gt; at 0x7fbbd5ab29e8&gt;
</code></pre>
<p>它跟下面这个冗长得多的生成器是完全等价的：</p>
<pre><code>def _make_gen():
    for x in range(100):
        yield x ** 2
gen = _make_gen()
</code></pre>
<p>生成器表达式也可以取代列表推导式，作为函数参数：</p>
<pre><code>In [191]: sum(x ** 2 for x in range(100))
Out[191]: 328350
In [192]: dict((i, i **2) for i in range(5))
Out[192]: {0: 0, 1: 1, 2: 4, 3: 9, 4: 16}
</code></pre>
<h5 id="itertools模块"><a href="#itertools模块" class="headerlink" title="itertools模块"></a><code>itertools</code>模块</h5><p>标准库<code>itertools</code>模块中有一组用于许多常见数据算法的生成器。例如，<code>groupby</code>可以接受任何序列和一个函数。它根据函数的返回值对序列中的连续元素进行分组。下面是一个例子：</p>
<pre><code>In [193]: import itertools
In [194]: first_letter = lambda x: x[0]
In [195]: names = ['Alan', 'Adam', 'Wes', 'Will', 'Albert', 'Steven']
In [196]: for letter, names in itertools.groupby(names, first_letter):
   .....:     print(letter, list(names)) # names is a generator
A ['Alan', 'Adam']
W ['Wes', 'Will']
A ['Albert']
S ['Steven']
</code></pre>
<p>下表中列出了一些我经常用到的<code>itertools</code>函数。建议参阅Python官方文档，进一步学习。</p>
<p><img src="https://tvax3.sinaimg.cn/large/007mx13gly1guomv4yveej60jc06pac302.jpg" alt="一些有用的itertools函数"></p>
<h4 id="错误和异常处理"><a href="#错误和异常处理" class="headerlink" title="错误和异常处理"></a>错误和异常处理</h4><p>优雅地处理Python的错误和异常是构建健壮程序的重要部分。在数据分析中，许多函数函数只用于部分输入。例如，Python的<code>float</code>函数可以将字符串转换成浮点数，但输入有误时，有ValueError错误：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">197</span><span class="token punctuation">]</span><span class="token punctuation">:</span> float('1.2345')
Out<span class="token punctuation">[</span><span class="token number">197</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">1.2345</span>
In <span class="token punctuation">[</span><span class="token number">198</span><span class="token punctuation">]</span><span class="token punctuation">:</span> float('something')
<span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span>
ValueError                                Traceback (most recent call last)
&lt;ipython<span class="token punctuation">-</span>input<span class="token punctuation">-</span>198<span class="token punctuation">-</span>439904410854<span class="token punctuation">&gt;</span> in &lt;module<span class="token punctuation">&gt;</span>()
<span class="token punctuation">---</span><span class="token punctuation">-</span><span class="token punctuation">&gt;</span> 1 float('something')
<span class="token key atrule">ValueError</span><span class="token punctuation">:</span> <span class="token key atrule">could not convert string to float</span><span class="token punctuation">:</span> <span class="token string">'something'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>假如想优雅地处理<code>float</code>的错误，让它返回输入值。我们可以写一个函数，在try/except中调用float：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">def attempt_float(x)</span><span class="token punctuation">:</span>
    <span class="token key atrule">try</span><span class="token punctuation">:</span>
        return float(x)
    <span class="token key atrule">except</span><span class="token punctuation">:</span>
        return x<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>当<code>float(x)</code>抛出异常时，才会执行<code>except</code>的部分：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">200</span><span class="token punctuation">]</span><span class="token punctuation">:</span> attempt_float('1.2345')
Out<span class="token punctuation">[</span><span class="token number">200</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">1.2345</span>
In <span class="token punctuation">[</span><span class="token number">201</span><span class="token punctuation">]</span><span class="token punctuation">:</span> attempt_float('something')
Out<span class="token punctuation">[</span><span class="token number">201</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'something'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>你可能注意到float抛出的异常不仅是<code>ValueError</code>：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">202</span><span class="token punctuation">]</span><span class="token punctuation">:</span> float((1<span class="token punctuation">,</span> 2))
<span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span>
TypeError                                 Traceback (most recent call last)
&lt;ipython<span class="token punctuation">-</span>input<span class="token punctuation">-</span>202<span class="token punctuation">-</span>842079ebb635<span class="token punctuation">&gt;</span> in &lt;module<span class="token punctuation">&gt;</span>()
<span class="token punctuation">---</span><span class="token punctuation">-</span><span class="token punctuation">&gt;</span> 1 float((1<span class="token punctuation">,</span> 2))
<span class="token key atrule">TypeError</span><span class="token punctuation">:</span> float() argument must be a string or a number<span class="token punctuation">,</span> not 'tuple'<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>你可能只想处理<code>ValueError，TypeError</code>错误（输入不是字符串或数值）可能是合理的bug。可以写一个异常类型：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">def attempt_float(x)</span><span class="token punctuation">:</span>
    <span class="token key atrule">try</span><span class="token punctuation">:</span>
        return float(x)
    <span class="token key atrule">except ValueError</span><span class="token punctuation">:</span>
        return x<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>然后有：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">204</span><span class="token punctuation">]</span><span class="token punctuation">:</span> attempt_float((1<span class="token punctuation">,</span> 2))
<span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span>
TypeError                                 Traceback (most recent call last)
&lt;ipython<span class="token punctuation">-</span>input<span class="token punctuation">-</span>204<span class="token punctuation">-</span>9bdfd730cead<span class="token punctuation">&gt;</span> in &lt;module<span class="token punctuation">&gt;</span>()
<span class="token punctuation">---</span><span class="token punctuation">-</span><span class="token punctuation">&gt;</span> 1 attempt_float((1<span class="token punctuation">,</span> 2))
&lt;ipython<span class="token punctuation">-</span>input<span class="token punctuation">-</span>203<span class="token punctuation">-</span>3e06b8379b6b<span class="token punctuation">&gt;</span> in attempt_float(x)
      <span class="token key atrule">1 def attempt_float(x)</span><span class="token punctuation">:</span>
      <span class="token key atrule">2     try</span><span class="token punctuation">:</span>
<span class="token punctuation">---</span><span class="token punctuation">-</span><span class="token punctuation">&gt;</span> 3         return float(x)
      <span class="token key atrule">4     except ValueError</span><span class="token punctuation">:</span>
      5         return x
<span class="token key atrule">TypeError</span><span class="token punctuation">:</span> float() argument must be a string or a number<span class="token punctuation">,</span> not 'tuple'<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>可以用<u>元组包含多个异常</u>：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">def attempt_float(x)</span><span class="token punctuation">:</span>
    <span class="token key atrule">try</span><span class="token punctuation">:</span>
        return float(x)
    except (TypeError<span class="token punctuation">,</span> <span class="token key atrule">ValueError)</span><span class="token punctuation">:</span>
        return x<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>某些情况下，你可能不想抑制异常，你想无论try部分的代码是否成功，都执行一段代码。可以使用finally：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">f = open(path<span class="token punctuation">,</span> 'w')
<span class="token key atrule">try</span><span class="token punctuation">:</span>
    write_to_file(f)
<span class="token key atrule">finally</span><span class="token punctuation">:</span>
    f.close()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这里，文件处理f总会被关闭。相似的，你可以用else让只在try部分成功的情况下，才执行代码：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">f = open(path<span class="token punctuation">,</span> 'w')
<span class="token key atrule">try</span><span class="token punctuation">:</span>
    write_to_file(f)
<span class="token key atrule">except</span><span class="token punctuation">:</span>
    print('Failed')
<span class="token key atrule">else</span><span class="token punctuation">:</span>
    print('Succeeded')
<span class="token key atrule">finally</span><span class="token punctuation">:</span>
    f.close()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="IPython的异常"><a href="#IPython的异常" class="headerlink" title="IPython的异常"></a>IPython的异常</h5><p>如果是在%run一个脚本或一条语句时抛出异常，IPython默认会打印完整的调用栈（traceback），在栈的每个点都会有几行上下文：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">:</span> %run examples/ipython_bug.py
<span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span>
AssertionError                            Traceback (most recent call last)
/home/wesm/code/pydata<span class="token punctuation">-</span>book/examples/ipython_bug.py in &lt;module<span class="token punctuation">&gt;</span>()
     13     throws_an_exception()
     14
<span class="token punctuation">---</span><span class="token punctuation">&gt;</span> 15 calling_things()
/home/wesm/code/pydata<span class="token punctuation">-</span>book/examples/ipython_bug.py in calling_things()
     <span class="token key atrule">11 def calling_things()</span><span class="token punctuation">:</span>
     12     works_fine()
<span class="token punctuation">---</span><span class="token punctuation">&gt;</span> 13     throws_an_exception()
     14
     15 calling_things()
/home/wesm/code/pydata<span class="token punctuation">-</span>book/examples/ipython_bug.py in throws_an_exception()
      7     a = 5
      8     b = 6
<span class="token punctuation">---</span><span class="token punctuation">-</span><span class="token punctuation">&gt;</span> 9     assert(a + b == 10)
     10
     <span class="token key atrule">11 def calling_things()</span><span class="token punctuation">:</span>
AssertionError<span class="token punctuation">:</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>自身就带有文本是相对于Python标准解释器的极大优点。你可以用魔术命令%xmode，从Plain（与Python标准解释器相同）到Verbose（带有函数的参数值）控制文本显示的数量。后面可以看到，发生错误之后，（用%debug或%pdb magics）可以进入stack进行事后调试。</p>
<h3 id="3-3-文件和操作系统"><a href="#3-3-文件和操作系统" class="headerlink" title="3.3 文件和操作系统"></a>3.3 文件和操作系统</h3><p>本书的代码示例大多使用诸如pandas.read_csv之类的高级工具将磁盘上的数据文件读入Python数据结构。但我们还是需要了解一些有关Python文件处理方面的基础知识。好在它本来就很简单，这也是Python在文本和文件处理方面的如此流行的原因之一。</p>
<p>为了打开一个文件以便读写，可以使用内置的<code>open</code>函数以及一个相对或绝对的文件路径：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">207</span><span class="token punctuation">]</span><span class="token punctuation">:</span> path = 'examples/segismundo.txt'
In <span class="token punctuation">[</span><span class="token number">208</span><span class="token punctuation">]</span><span class="token punctuation">:</span> f = open(path)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>默认情况下，文件是以只读模式<code>（’r’）</code>打开的。然后，我们就可以像处理列表那样来处理这个文件句柄f了，比如对行进行迭代：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">for line in f</span><span class="token punctuation">:</span>
    pass<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>从文件中取出的行都带有完整的行结束符（EOL），因此你常常会看到下面这样的代码（得到一组没有EOL的行）：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">209</span><span class="token punctuation">]</span><span class="token punctuation">:</span> lines = <span class="token punctuation">[</span>x.rstrip() for x in open(path)<span class="token punctuation">]</span>
In <span class="token punctuation">[</span><span class="token number">210</span><span class="token punctuation">]</span><span class="token punctuation">:</span> lines
Out<span class="token punctuation">[</span><span class="token number">210</span><span class="token punctuation">]</span><span class="token punctuation">:</span> 
<span class="token punctuation">[</span><span class="token string">'Sueña el rico en su riqueza,'</span><span class="token punctuation">,</span>
 <span class="token string">'que más cuidados le ofrece;'</span><span class="token punctuation">,</span>
 <span class="token string">''</span><span class="token punctuation">,</span>
 <span class="token string">'sueña el pobre que padece'</span><span class="token punctuation">,</span>
 <span class="token string">'su miseria y su pobreza;'</span><span class="token punctuation">,</span>
 <span class="token string">''</span><span class="token punctuation">,</span>
 <span class="token string">'sueña el que a medrar empieza,'</span><span class="token punctuation">,</span>
 <span class="token string">'sueña el que afana y pretende,'</span><span class="token punctuation">,</span>
 <span class="token string">'sueña el que agravia y ofende,'</span><span class="token punctuation">,</span>
 <span class="token string">''</span><span class="token punctuation">,</span>
 <span class="token string">'y en el mundo, en conclusión,'</span><span class="token punctuation">,</span>
 <span class="token string">'todos sueñan lo que son,'</span><span class="token punctuation">,</span>
 <span class="token string">'aunque ninguno lo entiende.'</span><span class="token punctuation">,</span>
 <span class="token string">''</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>如果<u>使用<code>open</code>创建文件对象，一定要用<code>close</code>关闭它</u>。关闭文件可以返回操作系统资源：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">211</span><span class="token punctuation">]</span><span class="token punctuation">:</span> f.close()<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>用<code>with</code>语句可以可以更容易地清理打开的文件：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">212</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token key atrule">with open(path) as f</span><span class="token punctuation">:</span>
   <span class="token key atrule">.....</span><span class="token punctuation">:</span>     lines = <span class="token punctuation">[</span>x.rstrip() for x in f<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>这样可以在退出代码块时，自动关闭文件。</p>
<p><code>rstrip()</code>函数： 删除 string 字符串末尾的指定字符（默认为空格），语法与实例如下：（可参考<a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-rstrip.html"><code>rstrip()</code> )</a>）</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token comment">#用法</span>
str.rstrip(<span class="token punctuation">[</span>chars<span class="token punctuation">]</span>)
<span class="token comment">#实例</span>
str = "     this is string example<span class="token punctuation">...</span>.wow<span class="token tag">!</span><span class="token tag">!</span><span class="token tag">!</span>     ";
print str.rstrip();
str = "88888888this is string example<span class="token punctuation">...</span>.wow<span class="token tag">!</span><span class="token tag">!!8888888</span>";
print str.rstrip('8');
<span class="token comment">#输出</span>
     this is string example<span class="token punctuation">...</span>.wow<span class="token tag">!</span><span class="token tag">!</span><span class="token tag">!</span>
88888888this is string example<span class="token punctuation">...</span>.wow<span class="token tag">!</span><span class="token tag">!</span><span class="token tag">!</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>如果输入<code>f =open(path,’w’)</code>，就会有一个新文件被创建在examples/segismundo.txt，并覆盖掉该位置原来的任何数据。另外有一个x文件模式，它可以创建可写的文件，但是如果文件路径存在，就无法创建。下表列出了所有的读/写模式。</p>
<p><img src="https://tvax2.sinaimg.cn/large/007mx13gly1gup4do8w6pj60yg0b3ad702.jpg" alt="Python的文件模式"></p>
<p>对于可读文件，一些常用的方法是<code>read、seek和tell</code>。<code>read</code>会从文件返回字符。字符的内容是由文件的编码决定的（如UTF-8），如果是二进制模式打开的就是原始字节：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">213</span><span class="token punctuation">]</span><span class="token punctuation">:</span> f = open(path)
In <span class="token punctuation">[</span><span class="token number">214</span><span class="token punctuation">]</span><span class="token punctuation">:</span> f.read(10)
Out<span class="token punctuation">[</span><span class="token number">214</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'Sueña el r'</span>
In <span class="token punctuation">[</span><span class="token number">215</span><span class="token punctuation">]</span><span class="token punctuation">:</span> f2 = open(path<span class="token punctuation">,</span> 'rb')  <span class="token comment"># Binary mode</span>
In <span class="token punctuation">[</span><span class="token number">216</span><span class="token punctuation">]</span><span class="token punctuation">:</span> f2.read(10)
Out<span class="token punctuation">[</span><span class="token number">216</span><span class="token punctuation">]</span><span class="token punctuation">:</span> b'Sue\xc3\xb1a el '<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>read</code>模式会将文件句柄的位置提前，<u>提前的数量是读取的字节数</u>。<code>tell</code>可以给出当前的位置：</p>
<pre class="line-numbers language-YAML" data-language="YAML"><code class="language-YAML">In [217]: f.tell()
Out[217]: 11
In [218]: f2.tell()
Out[218]: 10<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>尽管我们从文件读取了10个字符，位置却是11，这是因为用默认的编码用了这么多字节才解码了这10个字符。你可以用sys模块检查默认的编码：</p>
<pre class="line-numbers language-YAML" data-language="YAML"><code class="language-YAML">In [219]: import sys
In [220]: sys.getdefaultencoding()
Out[220]: 'utf-8'<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><code>seek</code>将文件位置更改为<u>文件中的指定字节</u>：</p>
<pre class="line-numbers language-YAML" data-language="YAML"><code class="language-YAML">In [221]: f.seek(3)
Out[221]: 3
In [222]: f.read(1)
Out[222]: 'ñ'<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>最后，关闭文件：</p>
<pre class="line-numbers language-YAML" data-language="YAML"><code class="language-YAML">In [223]: f.close()
In [224]: f2.close()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>向文件写入，可以使用文件的write或writelines方法。例如，我们可以创建一个无空行版的prof_mod.py：</p>
<pre class="line-numbers language-YAML" data-language="YAML"><code class="language-YAML">In [225]: with open('tmp.txt', 'w') as handle:
   .....:     handle.writelines(x for x in open(path) if len(x) &gt; 1)
In [226]: with open('tmp.txt') as f:
   .....:     lines = f.readlines()
In [227]: lines
Out[227]: 
['Sueña el rico en su riqueza,\n',
 'que más cuidados le ofrece;\n',
 'sueña el pobre que padece\n',
 'su miseria y su pobreza;\n',
 'sueña el que a medrar empieza,\n',
 'sueña el que afana y pretende,\n',
 'sueña el que agravia y ofende,\n',
 'y en el mundo, en conclusión,\n',
 'todos sueñan lo que son,\n',
 'aunque ninguno lo entiende.\n']<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>下表列出了一些最常用的文件方法。</p>
<p><img src="https://tvax2.sinaimg.cn/large/007mx13gly1gup4xa6mknj60yg0e8q7h02.jpg" alt="Python重要的文件方法或属性"></p>
<h5 id="文件的字节和Unicode"><a href="#文件的字节和Unicode" class="headerlink" title="文件的字节和Unicode"></a>文件的字节和Unicode</h5><p>Python文件的默认操作是“文本模式”，也就是说，你需要处理Python的字符串（即Unicode）。它与“二进制模式”相对，文件模式加一个b。我们来看上一节的文件（UTF-8编码、包含非ASCII字符）：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">230</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token key atrule">with open(path) as f</span><span class="token punctuation">:</span>
   <span class="token key atrule">.....</span><span class="token punctuation">:</span>     chars = f.read(10)
In <span class="token punctuation">[</span><span class="token number">231</span><span class="token punctuation">]</span><span class="token punctuation">:</span> chars
Out<span class="token punctuation">[</span><span class="token number">231</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'Sueña el r'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>UTF-8是长度可变的Unicode编码，所以当我从文件请求一定数量的字符时，Python会从文件读取足够多（可能少至10或多至40字节）的字节进行解码。如果以“rb”模式打开文件，则读取确切的请求字节数：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">232</span><span class="token punctuation">]</span><span class="token punctuation">:</span> with open(path<span class="token punctuation">,</span> 'rb') as f<span class="token punctuation">:</span>
   <span class="token key atrule">.....</span><span class="token punctuation">:</span>     data = f.read(10)
In <span class="token punctuation">[</span><span class="token number">233</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data
Out<span class="token punctuation">[</span><span class="token number">233</span><span class="token punctuation">]</span><span class="token punctuation">:</span> b'Sue\xc3\xb1a el '<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>取决于文本的编码，你可以将字节解码为str对象，但只有当<u>每个编码的Unicode字符都完全成形时</u>才能这么做：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">234</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data.decode('utf8')
Out<span class="token punctuation">[</span><span class="token number">234</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'Sueña el '</span>
In <span class="token punctuation">[</span><span class="token number">235</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span>.decode('utf8')
<span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span>
UnicodeDecodeError                        Traceback (most recent call last)
&lt;ipython<span class="token punctuation">-</span>input<span class="token punctuation">-</span>235<span class="token punctuation">-</span>300e0af10bb7<span class="token punctuation">&gt;</span> in &lt;module<span class="token punctuation">&gt;</span>()
<span class="token punctuation">---</span><span class="token punctuation">-</span><span class="token punctuation">&gt;</span> 1 data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span>.decode('utf8')
<span class="token key atrule">UnicodeDecodeError</span><span class="token punctuation">:</span> 'utf<span class="token punctuation">-</span><span class="token key atrule">8' codec can't decode byte 0xc3 in position 3</span><span class="token punctuation">:</span> unexpecte
d end of data<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>文本模式结合了<code>open</code>的编码选项，提供了一种更方便的方法将Unicode转换为另一种编码：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">236</span><span class="token punctuation">]</span><span class="token punctuation">:</span> sink_path = 'sink.txt'
In <span class="token punctuation">[</span><span class="token number">237</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token key atrule">with open(path) as source</span><span class="token punctuation">:</span>
   <span class="token key atrule">.....</span><span class="token punctuation">:</span>     with open(sink_path<span class="token punctuation">,</span> <span class="token string">'xt'</span><span class="token punctuation">,</span> <span class="token key atrule">encoding='iso-8859-1') as sink</span><span class="token punctuation">:</span>
   <span class="token key atrule">.....</span><span class="token punctuation">:</span>         sink.write(source.read())
In <span class="token punctuation">[</span><span class="token number">238</span><span class="token punctuation">]</span><span class="token punctuation">:</span> with open(sink_path<span class="token punctuation">,</span> <span class="token key atrule">encoding='iso-8859-1') as f</span><span class="token punctuation">:</span>
   <span class="token key atrule">.....</span><span class="token punctuation">:</span>     print(f.read(10))
Sueña el r<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>注意，<u>不要在二进制模式中使用<code>seek</code></u>。如果文件位置位于定义Unicode字符的字节的中间位置，读取后面会产生错误：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">240</span><span class="token punctuation">]</span><span class="token punctuation">:</span> f = open(path)
In <span class="token punctuation">[</span><span class="token number">241</span><span class="token punctuation">]</span><span class="token punctuation">:</span> f.read(5)
Out<span class="token punctuation">[</span><span class="token number">241</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'Sueña'</span>
In <span class="token punctuation">[</span><span class="token number">242</span><span class="token punctuation">]</span><span class="token punctuation">:</span> f.seek(4)
Out<span class="token punctuation">[</span><span class="token number">242</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">4</span>
In <span class="token punctuation">[</span><span class="token number">243</span><span class="token punctuation">]</span><span class="token punctuation">:</span> f.read(1)
<span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span>
UnicodeDecodeError                        Traceback (most recent call last)
&lt;ipython<span class="token punctuation">-</span>input<span class="token punctuation">-</span>243<span class="token punctuation">-</span>7841103e33f5<span class="token punctuation">&gt;</span> in &lt;module<span class="token punctuation">&gt;</span>()
<span class="token punctuation">---</span><span class="token punctuation">-</span><span class="token punctuation">&gt;</span> 1 f.read(1)
/miniconda/envs/book<span class="token punctuation">-</span>env/lib/python3.6/codecs.py in decode(self<span class="token punctuation">,</span> input<span class="token punctuation">,</span> final)
    319         <span class="token comment"># decode input (taking the buffer into account)</span>
    320         data = self.buffer + input
<span class="token punctuation">-</span><span class="token punctuation">-</span><span class="token punctuation">&gt;</span> 321         (result<span class="token punctuation">,</span> consumed) = self._buffer_decode(data<span class="token punctuation">,</span> self.errors<span class="token punctuation">,</span> final
)
    322         <span class="token comment"># keep undecoded input until the next call</span>
    323         self.buffer = data<span class="token punctuation">[</span>consumed<span class="token punctuation">:</span><span class="token punctuation">]</span>
<span class="token key atrule">UnicodeDecodeError</span><span class="token punctuation">:</span> 'utf<span class="token punctuation">-</span><span class="token key atrule">8' codec can't decode byte 0xb1 in position 0</span><span class="token punctuation">:</span> invalid s
tart byte
In <span class="token punctuation">[</span><span class="token number">244</span><span class="token punctuation">]</span><span class="token punctuation">:</span> f.close()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>如果你经常要对非ASCII字符文本进行数据分析，通晓Python的Unicode功能是非常重要的。更多内容，参阅Python官方文档。</p>
<h2 id="第-04-章-NumPy-基础：数组和矢量计算"><a href="#第-04-章-NumPy-基础：数组和矢量计算" class="headerlink" title="第 04 章 NumPy 基础：数组和矢量计算"></a><a target="_blank" rel="noopener" href="https://www.bookstack.cn/read/pyda-2e-zh/4.md">第 04 章 NumPy 基础：数组和矢量计算</a></h2><p>NumPy（Numerical Python的简称）是Python数值计算最重要的基础包。大多数提供科学计算的包都是用NumPy的数组作为构建基础。</p>
<p>NumPy的部分功能如下：</p>
<ul>
<li>ndarray，一个具有矢量算术运算和复杂广播能力的快速且节省空间的多维数组。</li>
<li>用于对整组数据进行快速运算的标准数学函数（无需编写循环）。</li>
<li>用于读写磁盘数据的工具以及用于操作内存映射文件的工具。</li>
<li>线性代数、随机数生成以及傅里叶变换功能。</li>
<li>用于集成由C、C++、Fortran等语言编写的代码的A C API。</li>
</ul>
<p>由于NumPy提供了一个简单易用的C API，因此很容易将数据传递给由低级语言编写的外部库，外部库也能以NumPy数组的形式将数据返回给Python。这个功能使Python成为一种包装C/C++/Fortran历史代码库的选择，并使被包装库拥有一个动态的、易用的接口。</p>
<p>NumPy本身并没有提供多么高级的数据分析功能，<u>理解NumPy数组以及面向数组的计算</u>将有助于你更加高效地使用诸如pandas之类的工具。因为NumPy是一个很大的题目，我会在附录A中介绍更多NumPy高级功能，比如广播。</p>
<p>对于大部分数据分析应用而言，我最关注的功能主要集中在：</p>
<ul>
<li>用于数据整理和清理、子集构造和过滤、转换等快速的矢量化数组运算。</li>
<li>常用的数组算法，如排序、唯一化、集合运算等。</li>
<li>高效的描述统计和数据聚合/摘要运算。</li>
<li>用于异构数据集的合并/连接运算的数据对齐和关系型数据运算。</li>
<li>将条件逻辑表述为数组表达式（而不是带有if-elif-else分支的循环）。</li>
<li>数据的分组运算（聚合、转换、函数应用等）</li>
</ul>
<p>虽然NumPy提供了通用的数值数据处理的计算基础，但大多数读者可能还是想将<u>pandas作为统计和分析工作</u>的基础，尤其是处理表格数据时。pandas还提供了一些NumPy所没有的领域特定的功能，如时间序列处理等。</p>
<ul>
<li>笔记：Python的面向数组计算可以追溯到1995年，Jim Hugunin创建了Numeric库。接下来的10年，许多科学编程社区纷纷开始使用Python的数组编程，但是进入21世纪，库的生态系统变得碎片化了。2005年，Travis Oliphant从Numeric和Numarray项目整了出了NumPy项目，进而所有社区都集合到了这个框架下。</li>
</ul>
<p>NumPy之于数值计算特别重要的原因之一，是因为它可以高效处理大数组的数据。这是因为：</p>
<ul>
<li>NumPy是在一个连续的内存块中存储数据，独立于其他Python内置对象。NumPy的C语言编写的算法库可以操作内存，而不必进行类型检查或其它前期工作。比起Python的内置序列，NumPy数组使用的内存更少。</li>
<li>NumPy可以在整个数组上执行复杂的计算，而不需要Python的for循环。</li>
</ul>
<p>要搞明白具体的性能差距，考察一个包含一百万整数的数组，和一个等价的Python列表：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">:</span> import numpy as np
In <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">:</span> my_arr = np.arange(1000000)
In <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">:</span> my_list = list(range(1000000))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>各个序列分别乘以2：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">:</span> %time for _ in range(10)<span class="token punctuation">:</span> my_arr2 = my_arr * 2
<span class="token key atrule">CPU times</span><span class="token punctuation">:</span> user 20 ms<span class="token punctuation">,</span> <span class="token key atrule">sys</span><span class="token punctuation">:</span> 50 ms<span class="token punctuation">,</span> <span class="token key atrule">total</span><span class="token punctuation">:</span> 70 ms
<span class="token key atrule">Wall time</span><span class="token punctuation">:</span> 72.4 ms
In <span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">:</span> %time for _ in range(10)<span class="token punctuation">:</span> my_list2 = <span class="token punctuation">[</span>x * 2 for x in my_list<span class="token punctuation">]</span>
<span class="token key atrule">CPU times</span><span class="token punctuation">:</span> user 760 ms<span class="token punctuation">,</span> <span class="token key atrule">sys</span><span class="token punctuation">:</span> 290 ms<span class="token punctuation">,</span> <span class="token key atrule">total</span><span class="token punctuation">:</span> 1.05 s
<span class="token key atrule">Wall time</span><span class="token punctuation">:</span> 1.05 s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>基于NumPy的算法要比纯Python快10到100倍（甚至更快），并且使用的内存更少。</p>
<h3 id="4-1-NumPy的ndarray：一种多维数组对象"><a href="#4-1-NumPy的ndarray：一种多维数组对象" class="headerlink" title="4.1 NumPy的ndarray：一种多维数组对象"></a>4.1 NumPy的ndarray：一种多维数组对象</h3><p><code>NumPy</code>最重要的一个特点就是其N维数组对象（即<code>ndarray</code>），该对象是一个快速而灵活的大数据集容器。你可以利用这种数组对整块数据执行一些数学运算，其语法跟标量元素之间的运算一样。</p>
<p>要明白Python是如何利用与标量值类似的语法进行批次计算，我先引入<code>NumPy</code>，然后生成一个包含随机数据的小数组：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">:</span> import numpy as np
<span class="token comment"># Generate some random data</span>
In <span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data = np.random.randn(2<span class="token punctuation">,</span> 3)
In <span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data
Out<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">:</span> 
array(<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">-0.2047</span><span class="token punctuation">,</span>  <span class="token number">0.4789</span><span class="token punctuation">,</span> <span class="token number">-0.5194</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">-0.5557</span><span class="token punctuation">,</span>  <span class="token number">1.9658</span><span class="token punctuation">,</span>  <span class="token number">1.3934</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>然后进行数学运算：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data * 10
Out<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">:</span> 
array(<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">-2.0471</span><span class="token punctuation">,</span>   <span class="token number">4.7894</span><span class="token punctuation">,</span>  <span class="token number">-5.1944</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span> <span class="token number">-5.5573</span><span class="token punctuation">,</span>  <span class="token number">19.6578</span><span class="token punctuation">,</span>  <span class="token number">13.9341</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)
In <span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data + data
Out<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">:</span> 
array(<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">-0.4094</span><span class="token punctuation">,</span>  <span class="token number">0.9579</span><span class="token punctuation">,</span> <span class="token number">-1.0389</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">-1.1115</span><span class="token punctuation">,</span>  <span class="token number">3.9316</span><span class="token punctuation">,</span>  <span class="token number">2.7868</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>第一个例子中，所有的元素都乘以10。第二个例子中，每个元素都与自身相加。</p>
<blockquote>
<p>笔记：在本章及全书中，我会使用标准的NumPy惯用法<code>import numpy as np</code>。你当然也可以在代码中使用<code>from numpy import *</code>，但不建议这么做。<code>numpy</code>的命名空间很大，包含许多函数，其中一些的名字与Python的内置函数重名（比如min和max）。</p>
</blockquote>
<p>ndarray是一个通用的同构数据多维容器，也就是说，其中的所有元素必须是相同类型的。每个数组都有一个shape（一个表示各维度大小的元组）和一个dtype（一个用于说明数组数据类型的对象）：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data.shape
Out<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">:</span> (2<span class="token punctuation">,</span> 3)
In <span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data.dtype
Out<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token punctuation">:</span> dtype('float64')<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>本章将会介绍<code>NumPy</code>数组的基本用法，这对于本书后面各章的理解基本够用。虽然大多数数据分析工作不需要深入理解<code>NumPy</code>，但是精通面向数组的编程和思维方式是成为Python科学计算牛人的一大关键步骤。</p>
<blockquote>
<p>笔记：当你在本书中看到“数组”、“<code>NumPy</code>数组”、”<code>ndarray</code>”时，基本上都指的是同一样东西，即<code>ndarray</code>对象。</p>
</blockquote>
<h4 id="创建ndarray"><a href="#创建ndarray" class="headerlink" title="创建ndarray"></a>创建<code>ndarray</code></h4><p>创建数组最简单的办法就是使用<code>array</code>函数。它接受一切序列型的对象（包括其他数组），然后产生一个新的含有传入数据的<code>NumPy</code>数组。以一个列表的转换为例：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data1 = <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7.5</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
In <span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr1 = np.array(data1)
In <span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr1
Out<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span> <span class="token number">6.</span> <span class="token punctuation">,</span>  <span class="token number">7.5</span><span class="token punctuation">,</span>  <span class="token number">8.</span> <span class="token punctuation">,</span>  <span class="token number">0.</span> <span class="token punctuation">,</span>  <span class="token number">1.</span> <span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>嵌套序列（比如由一组等长列表组成的列表）将会被转换为一个多维数组：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data2 = <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
In <span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr2 = np.array(data2)
In <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr2
Out<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">:</span> 
array(<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>因为data2是列表的列表，<code>NumPy</code>数组arr2的两个维度的shape是从data2引入的。可以用属性ndim和shape验证：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr2.ndim
Out<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">2</span>
In <span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr2.shape
Out<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">:</span> (2<span class="token punctuation">,</span> 4)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>除非特别说明（稍后将会详细介绍），<code>np.array</code>会尝试为新建的这个数组推断出一个较为合适的数据类型。数据类型保存在一个特殊的<code>dtype</code>对象中。比如说，在上面的两个例子中，我们有：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr1.dtype
Out<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token punctuation">:</span> dtype('float64')
In <span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr2.dtype
Out<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">:</span> dtype('int64')<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>除<code>np.array</code>之外，还有一些函数也可以新建数组。比如，zeros和ones分别可以创建指定长度或形状的全0或全1数组。empty可以创建一个没有任何具体值的数组。要用这些方法创建多维数组，只需传入一个表示形状的元组即可：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token punctuation">:</span> np.zeros(10)
Out<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span> <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">]</span>)
In <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">:</span> np.zeros((3<span class="token punctuation">,</span> 6))
Out<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">:</span> 
array(<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span> <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span> <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)
In <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span><span class="token punctuation">:</span> np.empty((2<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> 2))
Out<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span><span class="token punctuation">:</span> 
array(<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span> <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span> <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span> <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span> <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>注意：认为np.empty会返回全0数组的想法是不安全的。很多情况下（如前所示），它返回的都是一些未初始化的垃圾值。</p>
</blockquote>
<p><code>arange</code>是Python内置函数<code>range</code>的数组版：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">:</span> np.arange(15)Out<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>下表列出了一些数组创建函数。由于NumPy关注的是数值计算，因此，如果没有特别指定，数据类型基本都是float64（浮点数）。</p>
<p><img src="https://tvax3.sinaimg.cn/large/007mx13gly1guq8uv8wuzj60jc08xtd802.jpg" alt="数组创建函数"></p>
<h4 id="ndarray的数据类型"><a href="#ndarray的数据类型" class="headerlink" title="ndarray的数据类型"></a><code>ndarray</code>的数据类型</h4><p>dtype（数据类型）是一个特殊的对象，它含有<code>ndarray</code>将一块内存解释为特定数据类型所需的信息：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr1 = np.array(<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype=np.float64)    In <span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr2 = np.array(<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype=np.int32)    In <span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr1.dtype    Out<span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span><span class="token punctuation">:</span> dtype('float64')    In <span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr2.dtype    Out<span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span><span class="token punctuation">:</span> dtype('int32')<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>dtype是<code>NumPy</code>灵活交互其它系统的源泉之一。多数情况下，它们直接映射到相应的机器表示，这使得“读写磁盘上的二进制数据流”以及“集成低级语言代码（如C、Fortran）”等工作变得更加简单。数值型dtype的命名方式相同：一个类型名（如float或int），后面跟一个用于表示各元素位长的数字。标准的双精度浮点值（即Python中的float对象）需要占用8字节（即64位）。因此，该类型在NumPy中就记作float64。下表列出了NumPy所支持的全部数据类型。</p>
<blockquote>
<p>笔记：记不住这些NumPy的dtype也没关系，新手更是如此。通常只需要知道你所处理的数据的大致类型是浮点数、复数、整数、布尔值、字符串，还是普通的Python对象即可。当你需要控制数据在内存和磁盘中的存储方式时（尤其是对大数据集），那就得了解如何控制存储类型。</p>
</blockquote>
<p><img src="https://tva2.sinaimg.cn/large/007mx13gly1guq8vovj85j60y30l0jxz02.jpg" alt="一种多维数组对象"></p>
<p><img src="https://tvax1.sinaimg.cn/large/007mx13gly1guq8vq13wkj60y30boq6002.jpg" alt="一种多维数组对象"></p>
<p>你可以通过<code>ndarray</code>的astype方法明确地将一个数组从一个dtype转换成另一个dtype：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">37</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr = np.array(<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span>)In <span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr.dtypeOut<span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">]</span><span class="token punctuation">:</span> dtype('int64')In <span class="token punctuation">[</span><span class="token number">39</span><span class="token punctuation">]</span><span class="token punctuation">:</span> float_arr = arr.astype(np.float64)In <span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">:</span> float_arr.dtypeOut<span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">:</span> dtype('float64')<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>在本例中，整数被转换成了浮点数。如果将浮点数转换成整数，则小数部分将会被截取删除：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">41</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr = np.array(<span class="token punctuation">[</span><span class="token number">3.7</span><span class="token punctuation">,</span> <span class="token number">-1.2</span><span class="token punctuation">,</span> <span class="token number">-2.6</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">12.9</span><span class="token punctuation">,</span> <span class="token number">10.1</span><span class="token punctuation">]</span>)In <span class="token punctuation">[</span><span class="token number">42</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arrOut<span class="token punctuation">[</span><span class="token number">42</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span>  <span class="token number">3.7</span><span class="token punctuation">,</span>  <span class="token number">-1.2</span><span class="token punctuation">,</span>  <span class="token number">-2.6</span><span class="token punctuation">,</span>   <span class="token number">0.5</span><span class="token punctuation">,</span>  <span class="token number">12.9</span><span class="token punctuation">,</span>  <span class="token number">10.1</span><span class="token punctuation">]</span>)In <span class="token punctuation">[</span><span class="token number">43</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr.astype(np.int32)Out<span class="token punctuation">[</span><span class="token number">43</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">-1</span><span class="token punctuation">,</span> <span class="token number">-2</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype=int32)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>如果某字符串数组表示的全是数字，也可以用astype将其转换为数值形式：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">44</span><span class="token punctuation">]</span><span class="token punctuation">:</span> numeric_strings = np.array(<span class="token punctuation">[</span><span class="token string">'1.25'</span><span class="token punctuation">,</span> <span class="token string">'-9.6'</span><span class="token punctuation">,</span> <span class="token string">'42'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype=np.string_)In <span class="token punctuation">[</span><span class="token number">45</span><span class="token punctuation">]</span><span class="token punctuation">:</span> numeric_strings.astype(float)Out<span class="token punctuation">[</span><span class="token number">45</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span>  <span class="token number">1.25</span><span class="token punctuation">,</span>  <span class="token number">-9.6</span> <span class="token punctuation">,</span>  <span class="token number">42.</span>  <span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p>注意：使用<code>numpy.string</code>_类型时，一定要小心，因为<code>NumPy</code>的字符串数据是大小固定的，发生截取时，不会发出警告。<code>pandas</code>提供了更多非数值数据的便利的处理方法。</p>
</blockquote>
<p>如果转换过程因为某种原因而失败了（比如某个不能被转换为float64的字符串），就会引发一个ValueError。这里，我比较懒，写的是float而不是np.float64；NumPy很聪明，它会将Python类型映射到等价的dtype上。</p>
<p>数组的dtype还有另一个属性：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">46</span><span class="token punctuation">]</span><span class="token punctuation">:</span> int_array = np.arange(10)In <span class="token punctuation">[</span><span class="token number">47</span><span class="token punctuation">]</span><span class="token punctuation">:</span> calibers = np.array(<span class="token punctuation">[</span><span class="token number">.22</span><span class="token punctuation">,</span> <span class="token number">.270</span><span class="token punctuation">,</span> <span class="token number">.357</span><span class="token punctuation">,</span> <span class="token number">.380</span><span class="token punctuation">,</span> <span class="token number">.44</span><span class="token punctuation">,</span> <span class="token number">.50</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype=np.float64)In <span class="token punctuation">[</span><span class="token number">48</span><span class="token punctuation">]</span><span class="token punctuation">:</span> int_array.astype(calibers.dtype)Out<span class="token punctuation">[</span><span class="token number">48</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span> <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">1.</span><span class="token punctuation">,</span>  <span class="token number">2.</span><span class="token punctuation">,</span>  <span class="token number">3.</span><span class="token punctuation">,</span>  <span class="token number">4.</span><span class="token punctuation">,</span>  <span class="token number">5.</span><span class="token punctuation">,</span>  <span class="token number">6.</span><span class="token punctuation">,</span>  <span class="token number">7.</span><span class="token punctuation">,</span>  <span class="token number">8.</span><span class="token punctuation">,</span>  <span class="token number">9.</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>你还可以用简洁的类型代码来表示dtype：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">49</span><span class="token punctuation">]</span><span class="token punctuation">:</span> empty_uint32 = np.empty(8<span class="token punctuation">,</span> dtype='u4')In <span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">:</span> empty_uint32Out<span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span>         <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1075314688</span><span class="token punctuation">,</span>          <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1075707904</span><span class="token punctuation">,</span>          <span class="token number">0</span><span class="token punctuation">,</span>       <span class="token number">1075838976</span><span class="token punctuation">,</span>          <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1072693248</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype=uint32)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p>笔记：调用astype总会创建一个新的数组（一个数据的备份），即使新的dtype与旧的dtype相同。</p>
</blockquote>
<h4 id="NumPy数组的运算"><a href="#NumPy数组的运算" class="headerlink" title="NumPy数组的运算"></a><code>NumPy</code>数组的运算</h4><p>数组很重要，因为它使你不用编写循环即可对数据执行批量运算。NumPy用户称其为矢量化（vectorization）。大小相等的数组之间的任何算术运算都会将运算应用到元素级：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">51</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr = np.array(<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1.</span><span class="token punctuation">,</span> <span class="token number">2.</span><span class="token punctuation">,</span> <span class="token number">3.</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4.</span><span class="token punctuation">,</span> <span class="token number">5.</span><span class="token punctuation">,</span> <span class="token number">6.</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)In <span class="token punctuation">[</span><span class="token number">52</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arrOut<span class="token punctuation">[</span><span class="token number">52</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">1.</span><span class="token punctuation">,</span>  <span class="token number">2.</span><span class="token punctuation">,</span>  <span class="token number">3.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">4.</span><span class="token punctuation">,</span>  <span class="token number">5.</span><span class="token punctuation">,</span>  <span class="token number">6.</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)In <span class="token punctuation">[</span><span class="token number">53</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr * arrOut<span class="token punctuation">[</span><span class="token number">53</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token punctuation">[</span>  <span class="token number">1.</span><span class="token punctuation">,</span>   <span class="token number">4.</span><span class="token punctuation">,</span>   <span class="token number">9.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">16.</span><span class="token punctuation">,</span>  <span class="token number">25.</span><span class="token punctuation">,</span>  <span class="token number">36.</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)In <span class="token punctuation">[</span><span class="token number">54</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr <span class="token punctuation">-</span> arrOut<span class="token punctuation">[</span><span class="token number">54</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>数组与标量的算术运算会将标量值传播到各个元素：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">55</span><span class="token punctuation">]</span><span class="token punctuation">:</span> 1 / arrOut<span class="token punctuation">[</span><span class="token number">55</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">1.</span>    <span class="token punctuation">,</span>  <span class="token number">0.5</span>   <span class="token punctuation">,</span>  <span class="token number">0.3333</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">0.25</span>  <span class="token punctuation">,</span>  <span class="token number">0.2</span>   <span class="token punctuation">,</span>  <span class="token number">0.1667</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)In <span class="token punctuation">[</span><span class="token number">56</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr <span class="token important">**</span> 0.5Out<span class="token punctuation">[</span><span class="token number">56</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">1.</span>    <span class="token punctuation">,</span>  <span class="token number">1.4142</span><span class="token punctuation">,</span>  <span class="token number">1.7321</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">2.</span>    <span class="token punctuation">,</span>  <span class="token number">2.2361</span><span class="token punctuation">,</span>  <span class="token number">2.4495</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>大小相同的数组之间的比较会生成布尔值数组：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">57</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr2 = np.array(<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.</span><span class="token punctuation">,</span> <span class="token number">4.</span><span class="token punctuation">,</span> <span class="token number">1.</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7.</span><span class="token punctuation">,</span> <span class="token number">2.</span><span class="token punctuation">,</span> <span class="token number">12.</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)In <span class="token punctuation">[</span><span class="token number">58</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr2Out<span class="token punctuation">[</span><span class="token number">58</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token punctuation">[</span>  <span class="token number">0.</span><span class="token punctuation">,</span>   <span class="token number">4.</span><span class="token punctuation">,</span>   <span class="token number">1.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span>  <span class="token number">7.</span><span class="token punctuation">,</span>   <span class="token number">2.</span><span class="token punctuation">,</span>  <span class="token number">12.</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)In <span class="token punctuation">[</span><span class="token number">59</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr2 <span class="token punctuation">&gt;</span> arrOut<span class="token punctuation">[</span><span class="token number">59</span><span class="token punctuation">]</span><span class="token punctuation">:</span>array(<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token boolean important">False</span><span class="token punctuation">,</span>  <span class="token boolean important">True</span><span class="token punctuation">,</span> <span class="token boolean important">False</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token boolean important">True</span><span class="token punctuation">,</span> <span class="token boolean important">False</span><span class="token punctuation">,</span>  <span class="token boolean important">True</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype=bool)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>不同大小的数组之间的运算叫做广播（broadcasting），将在附录A中对其进行详细讨论。本书的内容不需要对广播机制有多深的理解。</p>
<h4 id="基本的索引和切片"><a href="#基本的索引和切片" class="headerlink" title="基本的索引和切片"></a>基本的索引和切片</h4><p>NumPy数组的索引是一个内容丰富的主题，因为选取数据子集或单个元素的方式有很多。一维数组很简单。从表面上看，它们跟Python列表的功能差不多：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">60</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr = np.arange(10)In <span class="token punctuation">[</span><span class="token number">61</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arrOut<span class="token punctuation">[</span><span class="token number">61</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span>)In <span class="token punctuation">[</span><span class="token number">62</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">62</span><span class="token punctuation">]</span><span class="token punctuation">:</span> 5In <span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr<span class="token punctuation">[</span>5<span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span>)In <span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr<span class="token punctuation">[</span>5<span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span> = 12In <span class="token punctuation">[</span><span class="token number">65</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arrOut<span class="token punctuation">[</span><span class="token number">65</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>如上所示，当你将一个标量值赋值给一个切片时（如arr[5:8]=12），该值会自动传播（也就说后面将会讲到的“广播”）到整个选区。跟列表最重要的区别在于，数组切片是原始数组的视图。这意味着数据不会被复制，视图上的任何修改都会直接反映到源数组上。</p>
<p>作为例子，先创建一个arr的切片：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">66</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr_slice = arr<span class="token punctuation">[</span>5<span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span>In <span class="token punctuation">[</span><span class="token number">67</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr_sliceOut<span class="token punctuation">[</span><span class="token number">67</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>现在，当我修稿arr_slice中的值，变动也会体现在原始数组arr中：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">68</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr_slice<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> = 12345In <span class="token punctuation">[</span><span class="token number">69</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arrOut<span class="token punctuation">[</span><span class="token number">69</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span>    <span class="token number">0</span><span class="token punctuation">,</span>     <span class="token number">1</span><span class="token punctuation">,</span>     <span class="token number">2</span><span class="token punctuation">,</span>     <span class="token number">3</span><span class="token punctuation">,</span>     <span class="token number">4</span><span class="token punctuation">,</span>    <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">12345</span><span class="token punctuation">,</span>    <span class="token number">12</span><span class="token punctuation">,</span>     <span class="token number">8</span><span class="token punctuation">,</span>   <span class="token number">9</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>切片[ : ]会给数组中的所有值赋值：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">70</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr_slice<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span> = 64In <span class="token punctuation">[</span><span class="token number">71</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arrOut<span class="token punctuation">[</span><span class="token number">71</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>如果你刚开始接触NumPy，可能会对此感到惊讶（尤其是当你曾经用过其他热衷于复制数组数据的编程语言）。由于NumPy的设计目的是处理大数据，所以你可以想象一下，假如NumPy坚持要将数据复制来复制去的话会产生何等的性能和内存问题。</p>
<blockquote>
<p>注意：如果你想要得到的是ndarray切片的一份副本而非视图，就需要明确地进行复制操作，例如<code>arr[5:8].copy()</code>。</p>
</blockquote>
<p>对于高维度数组，能做的事情更多。在一个二维数组中，各索引位置上的元素不再是标量而是一维数组：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">72</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr2d = np.array(<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)In <span class="token punctuation">[</span><span class="token number">73</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr2d<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">73</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>因此，可以对各个元素进行递归访问，但这样需要做的事情有点多。你可以传入一个以逗号隔开的索引列表来选取单个元素。也就是说，下面两种方式是等价的：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">74</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr2d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">74</span><span class="token punctuation">]</span><span class="token punctuation">:</span> 3In <span class="token punctuation">[</span><span class="token number">75</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr2d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">75</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">3</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>下图说明了二维数组的索引方式。轴0作为行，轴1作为列。</p>
<p><img src="https://tva1.sinaimg.cn/large/007mx13gly1guq91p9gxzj60kp0ifws802.jpg" alt="NumPy数组中的元素索引"></p>
<p>在多维数组中，如果省略了后面的索引，则返回对象会是一个维度低一点的<code>ndarray</code>（它含有高一级维度上的所有数据）。因此，在2×2×3数组arr3d中：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">76</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr3d = np.array(<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)In <span class="token punctuation">[</span><span class="token number">77</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr3dOut<span class="token punctuation">[</span><span class="token number">77</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span> <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>arr3d[0]是一个2×3数组：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">78</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr3d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    Out<span class="token punctuation">[</span><span class="token number">78</span><span class="token punctuation">]</span><span class="token punctuation">:</span>     array(<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>           <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>标量值和数组都可以被赋值给arr3d[0]：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">79</span><span class="token punctuation">]</span><span class="token punctuation">:</span> old_values = arr3d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>.copy()    In <span class="token punctuation">[</span><span class="token number">80</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr3d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> = 42    In <span class="token punctuation">[</span><span class="token number">81</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr3d    Out<span class="token punctuation">[</span><span class="token number">81</span><span class="token punctuation">]</span><span class="token punctuation">:</span>     array(<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">]</span><span class="token punctuation">,</span>            <span class="token punctuation">[</span><span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>           <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span>            <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)    In <span class="token punctuation">[</span><span class="token number">82</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr3d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> = old_values    In <span class="token punctuation">[</span><span class="token number">83</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr3d    Out<span class="token punctuation">[</span><span class="token number">83</span><span class="token punctuation">]</span><span class="token punctuation">:</span>     array(<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>            <span class="token punctuation">[</span> <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>           <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span>            <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>相似的，arr3d[1,0]可以访问索引以(1,0)开头的那些值（以一维数组的形式返回）：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">84</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr3d<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>    Out<span class="token punctuation">[</span><span class="token number">84</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>虽然是用两步进行索引的，表达式是相同的：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">85</span><span class="token punctuation">]</span><span class="token punctuation">:</span> x = arr3d<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>    In <span class="token punctuation">[</span><span class="token number">86</span><span class="token punctuation">]</span><span class="token punctuation">:</span> x    Out<span class="token punctuation">[</span><span class="token number">86</span><span class="token punctuation">]</span><span class="token punctuation">:</span>     array(<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span>           <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)    In <span class="token punctuation">[</span><span class="token number">87</span><span class="token punctuation">]</span><span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    Out<span class="token punctuation">[</span><span class="token number">87</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>注意，在上面所有这些选取数组子集的例子中，返回的数组都是视图。</p>
<h4 id="切片索引"><a href="#切片索引" class="headerlink" title="切片索引"></a>切片索引</h4><p>ndarray的切片语法跟Python列表这样的一维对象差不多：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">88</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arrOut<span class="token punctuation">[</span><span class="token number">88</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">]</span>)In <span class="token punctuation">[</span><span class="token number">89</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr<span class="token punctuation">[</span>1<span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">89</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span> <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>对于之前的二维数组arr2d，其切片方式稍显不同：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">90</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr2dOut<span class="token punctuation">[</span><span class="token number">90</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)In <span class="token punctuation">[</span><span class="token number">91</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr2d<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">91</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>可以看出，它是沿着第0轴（即第一个轴）切片的。也就是说，切片是沿着一个轴向选取元素的。表达式arr2d[:2]可以被认为是“选取arr2d的前两行”。</p>
<p>你可以一次传入多个切片，就像传入多个索引那样：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">92</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr2d<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span> 1<span class="token punctuation">:</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">92</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>像这样进行切片时，只能得到相同维数的数组视图。通过将整数索引和切片混合，可以得到低维度的切片。</p>
<p>例如，我可以选取第二行的前两列：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">93</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr2d<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">93</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>相似的，还可以选择第三列的前两行：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">94</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr2d<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">94</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>下图对此进行了说明。注意，“只有冒号”表示选取整个轴，因此你可以像下面这样只对高维轴进行切片：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">95</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr2d<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">95</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://static.sitestack.cn/projects/pyda-2e-zh/img/7178691-9da32d2f4629c304.png" alt="图4-2 二维数组切片"></p>
<p>自然，对切片表达式的赋值操作也会被扩散到整个选区：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">96</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr2d<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span> 1<span class="token punctuation">:</span><span class="token punctuation">]</span> = 0In <span class="token punctuation">[</span><span class="token number">97</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr2dOut<span class="token punctuation">[</span><span class="token number">97</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h4 id="布尔型索引"><a href="#布尔型索引" class="headerlink" title="布尔型索引"></a>布尔型索引</h4><p>来看这样一个例子，假设我们有一个用于存储数据的数组以及一个存储姓名的数组（含有重复项）。在这里，我将使用numpy.random中的randn函数生成一些正态分布的随机数据：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">98</span><span class="token punctuation">]</span><span class="token punctuation">:</span> names = np.array(<span class="token punctuation">[</span><span class="token string">'Bob'</span><span class="token punctuation">,</span> <span class="token string">'Joe'</span><span class="token punctuation">,</span> <span class="token string">'Will'</span><span class="token punctuation">,</span> <span class="token string">'Bob'</span><span class="token punctuation">,</span> <span class="token string">'Will'</span><span class="token punctuation">,</span> <span class="token string">'Joe'</span><span class="token punctuation">,</span> <span class="token string">'Joe'</span><span class="token punctuation">]</span>)In <span class="token punctuation">[</span><span class="token number">99</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data = np.random.randn(7<span class="token punctuation">,</span> 4)In <span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">:</span> namesOut<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token string">'Bob'</span><span class="token punctuation">,</span> <span class="token string">'Joe'</span><span class="token punctuation">,</span> <span class="token string">'Will'</span><span class="token punctuation">,</span> <span class="token string">'Bob'</span><span class="token punctuation">,</span> <span class="token string">'Will'</span><span class="token punctuation">,</span> <span class="token string">'Joe'</span><span class="token punctuation">,</span> <span class="token string">'Joe'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>dtype='&lt;U4')In <span class="token punctuation">[</span><span class="token number">101</span><span class="token punctuation">]</span><span class="token punctuation">:</span> dataOut<span class="token punctuation">[</span><span class="token number">101</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0.0929</span><span class="token punctuation">,</span>  <span class="token number">0.2817</span><span class="token punctuation">,</span>  <span class="token number">0.769</span> <span class="token punctuation">,</span>  <span class="token number">1.2464</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">1.0072</span><span class="token punctuation">,</span> <span class="token number">-1.2962</span><span class="token punctuation">,</span>  <span class="token number">0.275</span> <span class="token punctuation">,</span>  <span class="token number">0.2289</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">1.3529</span><span class="token punctuation">,</span>  <span class="token number">0.8864</span><span class="token punctuation">,</span> <span class="token number">-2.0016</span><span class="token punctuation">,</span> <span class="token number">-0.3718</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">1.669</span> <span class="token punctuation">,</span> <span class="token number">-0.4386</span><span class="token punctuation">,</span> <span class="token number">-0.5397</span><span class="token punctuation">,</span>  <span class="token number">0.477</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">3.2489</span><span class="token punctuation">,</span> <span class="token number">-1.0212</span><span class="token punctuation">,</span> <span class="token number">-0.5771</span><span class="token punctuation">,</span>  <span class="token number">0.1241</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">0.3026</span><span class="token punctuation">,</span>  <span class="token number">0.5238</span><span class="token punctuation">,</span>  <span class="token number">0.0009</span><span class="token punctuation">,</span>  <span class="token number">1.3438</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">-0.7135</span><span class="token punctuation">,</span> <span class="token number">-0.8312</span><span class="token punctuation">,</span> <span class="token number">-2.3702</span><span class="token punctuation">,</span> <span class="token number">-1.8608</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>假设每个名字都对应data数组中的一行，而我们想要选出对应于名字”Bob”的所有行。跟算术运算一样，数组的比较运算（如==）也是矢量化的。因此，对names和字符串”Bob”的比较运算将会产生一个布尔型数组：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">102</span><span class="token punctuation">]</span><span class="token punctuation">:</span> names == 'Bob'Out<span class="token punctuation">[</span><span class="token number">102</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span> <span class="token boolean important">True</span><span class="token punctuation">,</span> <span class="token boolean important">False</span><span class="token punctuation">,</span> <span class="token boolean important">False</span><span class="token punctuation">,</span>  <span class="token boolean important">True</span><span class="token punctuation">,</span> <span class="token boolean important">False</span><span class="token punctuation">,</span> <span class="token boolean important">False</span><span class="token punctuation">,</span> <span class="token boolean important">False</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype=bool)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>这个布尔型数组可用于数组索引：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">103</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data<span class="token punctuation">[</span>names == 'Bob'<span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">103</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0.0929</span><span class="token punctuation">,</span>  <span class="token number">0.2817</span><span class="token punctuation">,</span>  <span class="token number">0.769</span> <span class="token punctuation">,</span>  <span class="token number">1.2464</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">1.669</span> <span class="token punctuation">,</span> <span class="token number">-0.4386</span><span class="token punctuation">,</span> <span class="token number">-0.5397</span><span class="token punctuation">,</span>  <span class="token number">0.477</span> <span class="token punctuation">]</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>布尔型数组的长度必须跟被索引的轴长度一致。此外，还可以将布尔型数组跟切片、整数（或整数序列，稍后将对此进行详细讲解）混合使用：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">103</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data<span class="token punctuation">[</span>names == 'Bob'<span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">103</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0.0929</span><span class="token punctuation">,</span>  <span class="token number">0.2817</span><span class="token punctuation">,</span>  <span class="token number">0.769</span> <span class="token punctuation">,</span>  <span class="token number">1.2464</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">1.669</span> <span class="token punctuation">,</span> <span class="token number">-0.4386</span><span class="token punctuation">,</span> <span class="token number">-0.5397</span><span class="token punctuation">,</span>  <span class="token number">0.477</span> <span class="token punctuation">]</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p>注意：如果布尔型数组的长度不对，布尔型选择就会出错，因此一定要小心。</p>
</blockquote>
<p>下面的例子，我选取了<code>names == 'Bob'</code>的行，并索引了列：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">104</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data<span class="token punctuation">[</span>names == 'Bob'<span class="token punctuation">,</span> 2<span class="token punctuation">:</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">104</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0.769</span> <span class="token punctuation">,</span>  <span class="token number">1.2464</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">-0.5397</span><span class="token punctuation">,</span>  <span class="token number">0.477</span> <span class="token punctuation">]</span><span class="token punctuation">]</span>)In <span class="token punctuation">[</span><span class="token number">105</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data<span class="token punctuation">[</span>names == 'Bob'<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">105</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span> <span class="token number">1.2464</span><span class="token punctuation">,</span>  <span class="token number">0.477</span> <span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>要选择除”Bob”以外的其他值，既可以使用不等于符号（!=），也可以通过~对条件进行否定：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">106</span><span class="token punctuation">]</span><span class="token punctuation">:</span> names <span class="token tag">!=</span> 'Bob'Out<span class="token punctuation">[</span><span class="token number">106</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token boolean important">False</span><span class="token punctuation">,</span>  <span class="token boolean important">True</span><span class="token punctuation">,</span>  <span class="token boolean important">True</span><span class="token punctuation">,</span> <span class="token boolean important">False</span><span class="token punctuation">,</span>  <span class="token boolean important">True</span><span class="token punctuation">,</span>  <span class="token boolean important">True</span><span class="token punctuation">,</span>  <span class="token boolean important">True</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype=bool)In <span class="token punctuation">[</span><span class="token number">107</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data<span class="token punctuation">[</span>~(names == 'Bob')<span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">107</span><span class="token punctuation">]</span><span class="token punctuation">:</span>array(<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">1.0072</span><span class="token punctuation">,</span> <span class="token number">-1.2962</span><span class="token punctuation">,</span>  <span class="token number">0.275</span> <span class="token punctuation">,</span>  <span class="token number">0.2289</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">1.3529</span><span class="token punctuation">,</span>  <span class="token number">0.8864</span><span class="token punctuation">,</span> <span class="token number">-2.0016</span><span class="token punctuation">,</span> <span class="token number">-0.3718</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">3.2489</span><span class="token punctuation">,</span> <span class="token number">-1.0212</span><span class="token punctuation">,</span> <span class="token number">-0.5771</span><span class="token punctuation">,</span>  <span class="token number">0.1241</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">0.3026</span><span class="token punctuation">,</span>  <span class="token number">0.5238</span><span class="token punctuation">,</span>  <span class="token number">0.0009</span><span class="token punctuation">,</span>  <span class="token number">1.3438</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">-0.7135</span><span class="token punctuation">,</span> <span class="token number">-0.8312</span><span class="token punctuation">,</span> <span class="token number">-2.3702</span><span class="token punctuation">,</span> <span class="token number">-1.8608</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>~操作符用来反转条件很好用：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">108</span><span class="token punctuation">]</span><span class="token punctuation">:</span> cond = names == 'Bob'In <span class="token punctuation">[</span><span class="token number">109</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data<span class="token punctuation">[</span>~cond<span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">109</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">1.0072</span><span class="token punctuation">,</span> <span class="token number">-1.2962</span><span class="token punctuation">,</span>  <span class="token number">0.275</span> <span class="token punctuation">,</span>  <span class="token number">0.2289</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">1.3529</span><span class="token punctuation">,</span>  <span class="token number">0.8864</span><span class="token punctuation">,</span> <span class="token number">-2.0016</span><span class="token punctuation">,</span> <span class="token number">-0.3718</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">3.2489</span><span class="token punctuation">,</span> <span class="token number">-1.0212</span><span class="token punctuation">,</span> <span class="token number">-0.5771</span><span class="token punctuation">,</span>  <span class="token number">0.1241</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">0.3026</span><span class="token punctuation">,</span>  <span class="token number">0.5238</span><span class="token punctuation">,</span>  <span class="token number">0.0009</span><span class="token punctuation">,</span>  <span class="token number">1.3438</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">-0.7135</span><span class="token punctuation">,</span> <span class="token number">-0.8312</span><span class="token punctuation">,</span> <span class="token number">-2.3702</span><span class="token punctuation">,</span> <span class="token number">-1.8608</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>选取这三个名字中的两个需要组合应用多个布尔条件，使用&amp;（和）、|（或）之类的布尔算术运算符即可：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">110</span><span class="token punctuation">]</span><span class="token punctuation">:</span> mask = (names == 'Bob') <span class="token punctuation">|</span> (names == 'Will')In <span class="token punctuation">[</span><span class="token number">111</span><span class="token punctuation">]</span><span class="token punctuation">:</span> maskOut<span class="token punctuation">[</span><span class="token number">111</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span> <span class="token boolean important">True</span><span class="token punctuation">,</span> <span class="token boolean important">False</span><span class="token punctuation">,</span>  <span class="token boolean important">True</span><span class="token punctuation">,</span>  <span class="token boolean important">True</span><span class="token punctuation">,</span>  <span class="token boolean important">True</span><span class="token punctuation">,</span> <span class="token boolean important">False</span><span class="token punctuation">,</span> <span class="token boolean important">False</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype=bool)In <span class="token punctuation">[</span><span class="token number">112</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data<span class="token punctuation">[</span>mask<span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">112</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0.0929</span><span class="token punctuation">,</span>  <span class="token number">0.2817</span><span class="token punctuation">,</span>  <span class="token number">0.769</span> <span class="token punctuation">,</span>  <span class="token number">1.2464</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">1.3529</span><span class="token punctuation">,</span>  <span class="token number">0.8864</span><span class="token punctuation">,</span> <span class="token number">-2.0016</span><span class="token punctuation">,</span> <span class="token number">-0.3718</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">1.669</span> <span class="token punctuation">,</span> <span class="token number">-0.4386</span><span class="token punctuation">,</span> <span class="token number">-0.5397</span><span class="token punctuation">,</span>  <span class="token number">0.477</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">3.2489</span><span class="token punctuation">,</span> <span class="token number">-1.0212</span><span class="token punctuation">,</span> <span class="token number">-0.5771</span><span class="token punctuation">,</span>  <span class="token number">0.1241</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>通过布尔型索引选取数组中的数据，将总是创建数据的副本，即使返回一模一样的数组也是如此。</p>
<blockquote>
<p>注意：Python关键字and和or在布尔型数组中无效。要使用&amp;与|。</p>
</blockquote>
<p>通过布尔型数组设置值是一种经常用到的手段。为了将data中的所有负值都设置为0，我们只需：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">113</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data<span class="token punctuation">[</span>data &lt; 0<span class="token punctuation">]</span> = 0In <span class="token punctuation">[</span><span class="token number">114</span><span class="token punctuation">]</span><span class="token punctuation">:</span> dataOut<span class="token punctuation">[</span><span class="token number">114</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0.0929</span><span class="token punctuation">,</span>  <span class="token number">0.2817</span><span class="token punctuation">,</span>  <span class="token number">0.769</span> <span class="token punctuation">,</span>  <span class="token number">1.2464</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">1.0072</span><span class="token punctuation">,</span>  <span class="token number">0.</span>    <span class="token punctuation">,</span>  <span class="token number">0.275</span> <span class="token punctuation">,</span>  <span class="token number">0.2289</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">1.3529</span><span class="token punctuation">,</span>  <span class="token number">0.8864</span><span class="token punctuation">,</span>  <span class="token number">0.</span>    <span class="token punctuation">,</span>  <span class="token number">0.</span>    <span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">1.669</span> <span class="token punctuation">,</span>  <span class="token number">0.</span>    <span class="token punctuation">,</span>  <span class="token number">0.</span>    <span class="token punctuation">,</span>  <span class="token number">0.477</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">3.2489</span><span class="token punctuation">,</span>  <span class="token number">0.</span>    <span class="token punctuation">,</span>  <span class="token number">0.</span>    <span class="token punctuation">,</span>  <span class="token number">0.1241</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">0.3026</span><span class="token punctuation">,</span>  <span class="token number">0.5238</span><span class="token punctuation">,</span>  <span class="token number">0.0009</span><span class="token punctuation">,</span>  <span class="token number">1.3438</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">0.</span>    <span class="token punctuation">,</span>  <span class="token number">0.</span>    <span class="token punctuation">,</span>  <span class="token number">0.</span>    <span class="token punctuation">,</span>  <span class="token number">0.</span>    <span class="token punctuation">]</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>通过一维布尔数组设置整行或列的值也很简单：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">115</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data<span class="token punctuation">[</span>names <span class="token tag">!=</span> 'Joe'<span class="token punctuation">]</span> = 7In <span class="token punctuation">[</span><span class="token number">116</span><span class="token punctuation">]</span><span class="token punctuation">:</span> dataOut<span class="token punctuation">[</span><span class="token number">116</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">7.</span>    <span class="token punctuation">,</span>  <span class="token number">7.</span>    <span class="token punctuation">,</span>  <span class="token number">7.</span>    <span class="token punctuation">,</span>  <span class="token number">7.</span>    <span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">1.0072</span><span class="token punctuation">,</span>  <span class="token number">0.</span>    <span class="token punctuation">,</span>  <span class="token number">0.275</span> <span class="token punctuation">,</span>  <span class="token number">0.2289</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">7.</span>    <span class="token punctuation">,</span>  <span class="token number">7.</span>    <span class="token punctuation">,</span>  <span class="token number">7.</span>    <span class="token punctuation">,</span>  <span class="token number">7.</span>    <span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">7.</span>    <span class="token punctuation">,</span>  <span class="token number">7.</span>    <span class="token punctuation">,</span>  <span class="token number">7.</span>    <span class="token punctuation">,</span>  <span class="token number">7.</span>    <span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">7.</span>    <span class="token punctuation">,</span>  <span class="token number">7.</span>    <span class="token punctuation">,</span>  <span class="token number">7.</span>    <span class="token punctuation">,</span>  <span class="token number">7.</span>    <span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">0.3026</span><span class="token punctuation">,</span>  <span class="token number">0.5238</span><span class="token punctuation">,</span>  <span class="token number">0.0009</span><span class="token punctuation">,</span>  <span class="token number">1.3438</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">0.</span>    <span class="token punctuation">,</span>  <span class="token number">0.</span>    <span class="token punctuation">,</span>  <span class="token number">0.</span>    <span class="token punctuation">,</span>  <span class="token number">0.</span>    <span class="token punctuation">]</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>后面会看到，这类二维数据的操作也可以用pandas方便的来做。</p>
<h4 id="花式索引"><a href="#花式索引" class="headerlink" title="花式索引"></a>花式索引</h4><p>花式索引（Fancy indexing）是一个NumPy术语，它指的是利用整数数组进行索引。假设我们有一个8×4数组：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">117</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr = np.empty((8<span class="token punctuation">,</span> 4))In <span class="token punctuation">[</span><span class="token number">118</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token key atrule">for i in range(8):.....</span><span class="token punctuation">:</span>     arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> = iIn <span class="token punctuation">[</span><span class="token number">119</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arrOut<span class="token punctuation">[</span><span class="token number">119</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">1.</span><span class="token punctuation">,</span>  <span class="token number">1.</span><span class="token punctuation">,</span>  <span class="token number">1.</span><span class="token punctuation">,</span>  <span class="token number">1.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">2.</span><span class="token punctuation">,</span>  <span class="token number">2.</span><span class="token punctuation">,</span>  <span class="token number">2.</span><span class="token punctuation">,</span>  <span class="token number">2.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">3.</span><span class="token punctuation">,</span>  <span class="token number">3.</span><span class="token punctuation">,</span>  <span class="token number">3.</span><span class="token punctuation">,</span>  <span class="token number">3.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">4.</span><span class="token punctuation">,</span>  <span class="token number">4.</span><span class="token punctuation">,</span>  <span class="token number">4.</span><span class="token punctuation">,</span>  <span class="token number">4.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">5.</span><span class="token punctuation">,</span>  <span class="token number">5.</span><span class="token punctuation">,</span>  <span class="token number">5.</span><span class="token punctuation">,</span>  <span class="token number">5.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">6.</span><span class="token punctuation">,</span>  <span class="token number">6.</span><span class="token punctuation">,</span>  <span class="token number">6.</span><span class="token punctuation">,</span>  <span class="token number">6.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">7.</span><span class="token punctuation">,</span>  <span class="token number">7.</span><span class="token punctuation">,</span>  <span class="token number">7.</span><span class="token punctuation">,</span>  <span class="token number">7.</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>为了以特定顺序选取行子集，只需传入一个用于指定顺序的整数列表或<code>ndarray</code>即可：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">120</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">120</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">4.</span><span class="token punctuation">,</span>  <span class="token number">4.</span><span class="token punctuation">,</span>  <span class="token number">4.</span><span class="token punctuation">,</span>  <span class="token number">4.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">3.</span><span class="token punctuation">,</span>  <span class="token number">3.</span><span class="token punctuation">,</span>  <span class="token number">3.</span><span class="token punctuation">,</span>  <span class="token number">3.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">6.</span><span class="token punctuation">,</span>  <span class="token number">6.</span><span class="token punctuation">,</span>  <span class="token number">6.</span><span class="token punctuation">,</span>  <span class="token number">6.</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>这段代码确实达到我们的要求了！使用负数索引将会从末尾开始选取行：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">121</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">-3</span><span class="token punctuation">,</span> <span class="token number">-5</span><span class="token punctuation">,</span> <span class="token number">-7</span><span class="token punctuation">]</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">121</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">5.</span><span class="token punctuation">,</span>  <span class="token number">5.</span><span class="token punctuation">,</span>  <span class="token number">5.</span><span class="token punctuation">,</span>  <span class="token number">5.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">3.</span><span class="token punctuation">,</span>  <span class="token number">3.</span><span class="token punctuation">,</span>  <span class="token number">3.</span><span class="token punctuation">,</span>  <span class="token number">3.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">1.</span><span class="token punctuation">,</span>  <span class="token number">1.</span><span class="token punctuation">,</span>  <span class="token number">1.</span><span class="token punctuation">,</span>  <span class="token number">1.</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>一次传入多个索引数组会有一点特别。它返回的是一个一维数组，其中的元素对应各个索引元组：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">122</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr = np.arange(32).reshape((8<span class="token punctuation">,</span> 4))In <span class="token punctuation">[</span><span class="token number">123</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arrOut<span class="token punctuation">[</span><span class="token number">123</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)In <span class="token punctuation">[</span><span class="token number">124</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">124</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>附录A中会详细介绍reshape方法。</p>
<p>最终选出的是元素(1,0)、(5,3)、(7,1)和(2,2)。无论数组是多少维的，花式索引总是一维的。</p>
<p>这个花式索引的行为可能会跟某些用户的预期不一样（包括我在内），选取矩阵的行列子集应该是矩形区域的形式才对。下面是得到该结果的一个办法：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">125</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">125</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p>记住，花式索引跟切片不一样，它总是将数据复制到新数组中。</p>
</blockquote>
<h4 id="数组转置和轴对换"><a href="#数组转置和轴对换" class="headerlink" title="数组转置和轴对换"></a>数组转置和轴对换</h4><p>转置是重塑的一种特殊形式，它返回的是源数据的视图（不会进行任何复制操作）。数组不仅有transpose方法，还有一个特殊的T属性：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">126</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr = np.arange(15).reshape((3<span class="token punctuation">,</span> 5))In <span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arrOut<span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)In <span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr.TOut<span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>在进行矩阵计算时，经常需要用到该操作，比如利用np.dot计算矩阵内积：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">129</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr = np.random.randn(6<span class="token punctuation">,</span> 3)In <span class="token punctuation">[</span><span class="token number">130</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arrOut<span class="token punctuation">[</span><span class="token number">130</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">-0.8608</span><span class="token punctuation">,</span>  <span class="token number">0.5601</span><span class="token punctuation">,</span> <span class="token number">-1.2659</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">0.1198</span><span class="token punctuation">,</span> <span class="token number">-1.0635</span><span class="token punctuation">,</span>  <span class="token number">0.3329</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">-2.3594</span><span class="token punctuation">,</span> <span class="token number">-0.1995</span><span class="token punctuation">,</span> <span class="token number">-1.542</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">-0.9707</span><span class="token punctuation">,</span> <span class="token number">-1.307</span> <span class="token punctuation">,</span>  <span class="token number">0.2863</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">0.378</span> <span class="token punctuation">,</span> <span class="token number">-0.7539</span><span class="token punctuation">,</span>  <span class="token number">0.3313</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">1.3497</span><span class="token punctuation">,</span>  <span class="token number">0.0699</span><span class="token punctuation">,</span>  <span class="token number">0.2467</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)In <span class="token punctuation">[</span><span class="token number">131</span><span class="token punctuation">]</span><span class="token punctuation">:</span> np.dot(arr.T<span class="token punctuation">,</span> arr)Out<span class="token punctuation">[</span><span class="token number">131</span><span class="token punctuation">]</span><span class="token punctuation">:</span>array(<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">9.2291</span><span class="token punctuation">,</span>  <span class="token number">0.9394</span><span class="token punctuation">,</span>  <span class="token number">4.948</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">0.9394</span><span class="token punctuation">,</span>  <span class="token number">3.7662</span><span class="token punctuation">,</span> <span class="token number">-1.3622</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">4.948</span> <span class="token punctuation">,</span> <span class="token number">-1.3622</span><span class="token punctuation">,</span>  <span class="token number">4.3437</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>对于高维数组，transpose需要得到一个由轴编号组成的元组才能对这些轴进行转置（比较费脑子）：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">132</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr = np.arange(16).reshape((2<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> 4))In <span class="token punctuation">[</span><span class="token number">133</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arrOut<span class="token punctuation">[</span><span class="token number">133</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span> <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)In <span class="token punctuation">[</span><span class="token number">134</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr.transpose((1<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> 2))Out<span class="token punctuation">[</span><span class="token number">134</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span> <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>这里，第一个轴被换成了第二个，第二个轴被换成了第一个，最后一个轴不变。</p>
<p>简单的转置可以使用.T，它其实就是进行轴对换而已。ndarray还有一个swapaxes方法，它需要接受一对轴编号：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">In <span class="token punctuation">[</span><span class="token number">135</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arrOut<span class="token punctuation">[</span><span class="token number">135</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span> <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)In <span class="token punctuation">[</span><span class="token number">136</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr.swapaxes(1<span class="token punctuation">,</span> 2)Out<span class="token punctuation">[</span><span class="token number">136</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array(<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span> <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span> <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span> <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>swapaxes也是返回源数据的视图（不会进行任何复制操作）。</p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">CaoDong street</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://example.com/2021/09/21/python-xue-xi-bi-ji/">http://example.com/2021/09/21/python-xue-xi-bi-ji/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">CaoDong street</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/python/">
                                    <span class="chip bg-color">python</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="far fa-dot-circle"></i>&nbsp;本篇
            </div>
            <div class="card">
                <a href="/2021/09/21/python-xue-xi-bi-ji/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/13.jpg" class="responsive-img" alt="python学习笔记（数据分析）">
                        
                        <span class="card-title">python学习笔记（数据分析）</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            《利用Python进行数据分析·第2版》的学习（进度：4.1节）
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-09-21
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%BB%8F%E9%AA%8C/" class="post-category">
                                    学习经验
                                </a>
                            
                            
                        </span>
                    </div>
                </div>

                
                <div class="card-action article-tags">
                    
                    <a href="/tags/python/">
                        <span class="chip bg-color">python</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2021/09/19/hexo-bo-ke-chu-xian-de-wen-ti-ji-chu-li-fang-fa/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/2.jpg" class="responsive-img" alt="hexo博客出现的问题及处理方法">
                        
                        <span class="card-title">hexo博客出现的问题及处理方法</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            解决问题：添加图片
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-09-19
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%BB%8F%E9%AA%8C/" class="post-category">
                                    学习经验
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Hexo/">
                        <span class="chip bg-color">Hexo</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="tencent"
                   type="playlist"
                   id="003TEnl83gBNge"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>

    
    <div class="container row center-align" style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2021</span>
            
            <span id="year">2021</span>
            <a href="/about" target="_blank">Cao Dong street</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                class="white-color">26k</span>&nbsp;字
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;次
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;人
            </span>
            
            <br>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/CaoDong-street" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:zy3144976384@gmail.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=3144976384" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 3144976384" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

	
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
